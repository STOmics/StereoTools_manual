{"./":{"url":"./","title":"时空数据分析软件（SDAS）使用手册","summary":"版本：SDAS 1.0.0","keywords":"","body":"时空数据分析软件（SDAS）使用手册时空数据分析软件（SDAS）使用手册 软件简介安装指南快速入门各功能模块使用说明流程示例版本说明技术支持 ©2025 深圳华大三箭齐发科技有限责任公司保留所有权利。 本产品仅用于研究，不用于诊断。 本手册上的内容可能全部或部分受到适用的知识产权法的保护。深圳华大三箭齐发科技有限责任公司和/或相应权利主体依法拥有其知识产权，包括但不限于商标权、版权等。 深圳华大三箭齐发科技有限责任公司不授予或暗示使用我们或任何第三方的任何版权内容或商标（注册或未注册）的权利或许可。未经本单位书面同意，任何人不得擅自使用、修改、复制、公开传播、更改、分发或发布本手册的程序或内容，不得使用或利用设计技巧使用或占有本单位或本单位关联方的商标、标识或其他专有信息（包括图像、文本、网页设计或形式）。 此处的任何内容都无意于或应被理解为对此处列出或描述的任何产品的性能的任何保证、表达或暗示。适用于本文所列任何产品的任何和所有保证均载于购买该产品所附的适用销售条款和条件。深圳华大三箭齐发科技有限责任公司不做任何保证，并在此声明对本文所述任何第三方产品或协议的使用不做任何保证。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/01_sdas_intro.html":{"url":"readme/01_sdas_intro.html","title":"软件简介","keywords":"","body":"软件简介Stereo Data Analysis Solution (SDAS)软件软件简介 Stereo Data Analysis Solution (SDAS)软件 STOmics开发的一套时空组学数据高级生物信息分析软件，专为时空组学数据（STOmics平台数据）提供全流程数据分析解决方案。 功能模块：包含14个功能模块，共31个算法/方法。具体有：数据处理，细胞类型注释，空间结构域识别，细胞邻域分析，CNV分析，空间基因共表达，差异基因识别，基因集富集分析，基因调控网络分析，细胞通讯分析，轨迹分析，转录因子分析，细胞空间距离分析，和公共数据库验证。 输入：h5ad文件（如SAW count，SAW convert gef2h5ad生成），SAW aggr生成的h5mu文件，rds文件 输出：h5ad，rds，csv，txt，png和pdf文件 输出：h5ad，rds，csv，txt，png和pdf文件 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/02_install.html":{"url":"readme/02_install.html","title":"安装指南","keywords":"","body":"安装指南1. 系统配置要求2. 软件下载3. 安装4. 测试运行安装指南 1. 系统配置要求 SDAS分析软件包在Linux系统上被解压和安装，计算环境需满足下列基本要求： * 8-core Intel or AMD processor (>24 cores recommended) 128GB RAM (>256GB recommended) 200G free disk space or higher * 64-bit CentOS/RedHat 7.8 or Ubuntu 20.04 2. 软件下载 华大网盘：https://bgipan.genomics.cn/ （链接和提取密码通过其他方式获取） Github: git clone https://github.com/STOmics/SDAS.git（无tar.gz和测试数据） 3. 安装 重要提示!!!：解压完成后必须执行setup.sh脚本以确保R路径相关模块正常运行。安装后请勿更改软件安装位置或重命名软件目录，以免导致路径配置失效。 tar -xzf sdas-1.0.0.tar.gz cd sdas-1.0.0 sh setup.sh 4. 测试运行 ./SDAS -h 5. 其他说明 软件压缩包共30G，解压后70G 关于GPU使用的说明：请用户自行安装CUDA >= 11.8，参考https://docs.nvidia.com/cuda/cuda-installation-guide-linux/ © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/03_quickstart.html":{"url":"readme/03_quickstart.html","title":"快速入门","keywords":"","body":"快速入门0. 测试信息测试数据：测试脚本：1. 获取SAW输出的文件2. 细胞类型注释3. 空间结构域识别4. 细胞邻域分析5. CNV分析6. 空间基因共表达分析7. 差异基因分析8. 基因集富集分析9. 蛋白相互作用10. 细胞通讯分析11. 轨迹分析12. 转录因子分析13. 空间关系分析14. 公共数据验证快速入门 0. 测试信息 测试数据： ./Test_data 测试脚本： ./Scripts/quick_start 1. 获取SAW输出的文件 方式一：直接下载SAW count输出的h5ad文件 方式二：从gef转h5ad：saw convert gef2h5ad --gef=sample.tissue.gef --bin-size=100 --h5ad=sample.h5ad 方式三：直接下载SAW aggr(alpha ver.)输出的h5mu文件 2. 细胞类型注释 cell2locationMakeRef 构建单细胞参考数据 SDAS cellAnnotation cell2locationMakeRef --reference ../Test_data/single_slice/sample_ref.h5ad -o ../output/cellAnnotation_cell2location_ref --label_key annotation2 --filter_rare_cell 0 --cell_percentage_cutoff2 0.05 --nonz_mean_cutoff 1.45 --gpu_id 0 cell2location SDAS cellAnnotation cell2location -i ../Test_data/single_slice/sample.h5ad -o ../output/cell2location --reference_csv ../output/cellAnnotation_cell2location_ref/sample_ref_inf_aver.csv --input_gene_symbol_key _index --bin_size 100 --gpu_id 0 RCTD SDAS cellAnnotation rctd -i ../Test_data/single_slice/sample.h5ad -o ../output/cellAnnotation_rctd --reference ../Test_data/single_slice/sample_ref.h5ad --label_key annotation2 --input_gene_symbol_key _index --filter_rare_cell 0 --bin_size 100 3. 空间结构域识别 graphST SDAS spatialDomain graphst -i ../Test_data/single_slice/sample.h5ad -o ../output/spatialDomain_graphST --gpu_id 0 --tool mclust --n_clusters 10 --n_hvg 3000 --bin_size 100 4. 细胞邻域分析 SDAS cellularNeighborhood singleCelltype -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/cellularNeighborhood_singleCelltype --bin_size 100 --label_key anno_rctd 5. CNV分析 使用细胞注释后的h5ad，准备rds文件： SDAS dataProcess h5ad2rds -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/cellAnnotation_rctd 运行inferCNV SDAS infercnv -i ../output/cellAnnotation_rctd/sample_anno_rctd.rds --h5ad ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/infercnv --bin_size 100 --label_key anno_rctd --gene_symbol_key _index --species human --cutoff 0.02 --ref_group_names Mac_SPP1,Monocyte_S100A8,Plasma_IgG,CD8_Tem 6. 空间基因共表达分析 hdWGCNA SDAS coexpress hdwgcna -i ../Test_data/single_slice/sample.h5ad -o ../output/coexpress_hdwgcna --bin_size 100 --selected_genes top5000 7. 差异基因分析 wilcoxon SDAS DEG -i ../output/spatialDomain_graphST/sample_domain_graphst.h5ad -o ../output/DEG_wilcoxon --de_method wilcoxon --group_key domain_graphst --ident1 3 --ident2 8 8. 基因集富集分析 GSEA SDAS geneSetEnrichment gsea -i ../output/spatialDomain_graphST/sample_domain_graphst.h5ad -o ../output/geneSetEnrichment_gsea --species human --group_key domain_graphst --ident1 3 --ident2 8 --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt Enrichr SDAS geneSetEnrichment enrichr -i ../output/DEG_wilcoxon/de_wilcoxon.domain_graphst.3-vs-8.sig_filtered.csv -o ../output/geneSetEnrichment_enrichr --species human --cut_off 0.05 9. 蛋白相互作用 SDAS PPI -i ../Test_data/PPI/gene_300.txt -o ../output/PPI --species human --cluster GN 10. 细胞通讯分析 cellchat SDAS CCI cellchat -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/CCI_cellchat_nospatial --label_key anno_rctd --gene_symbol_key _index --species human --type truncatedMean 11. 轨迹分析 使用注释后的h5ad，准备rds文件： SDAS dataProcess h5ad2rds -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/cellAnnotation_rctd 运行monocle3： SDAS trajectory monocle3 -i ../output/cellAnnotation_rctd/sample_anno_rctd.rds -o ../output/trajectory_monocle3 --gene_symbol_key _index --root_key anno_rctd --root CAF_CXCL14 12. 转录因子分析 SDAS TF -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/TF --label_key anno_rctd --gene_symbol_key _index --species human 13. 空间关系分析 squidpy SDAS spatialRelate squidpy -i ../output/cellAnnotation_rctd/sample_anno_rctd.h5ad -o ../output/spatialRelate_squidpy --label_key anno_rctd --bin_size 100 --min_cells_per_type 3 --coord_type grid 14. 公共数据验证 immuneScore SDAS bulkValidate immuneScore --expression ../Test_data/bulkValidate/fpkm.txt --clinical ../Test_data/bulkValidate/clinical.txt -o ../output/bulkValidate_immuneScore --group_col tissue_type.samples --group_type discrete survivalKM SDAS bulkValidate survivalKM --input ../output/bulkValidate_immuneScore/tme_combine.txt --clinical ../Test_data/bulkValidate/clinical.txt -o ../output/bulkValidate_survivalKM --signature Macrophages_M2_CIBERSORT --project_name survival --time OS.time --status OS.status --time_type day © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/":{"url":"readme/04_manual/","title":"各功能模块使用说明","keywords":"","body":"各功能模块使用说明各功能模块使用说明 对14个功能模块进行详细介绍，包括用途，运行方式，输入参数说明、输出结果说明、调参建议和性能测试。功能模块介绍的顺序为：数据处理，细胞类型注释，空间结构域识别，细胞邻域分析，CNV分析，空间基因共表达，差异基因识别，基因集富集分析，蛋白互作网络分析，细胞通讯分析，轨迹分析，转录因子分析，细胞空间距离分析，和公共数据库验证。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/sdas_input.html":{"url":"readme/04_manual/sdas_input.html","title":"SDAS输入数据格式描述","keywords":"","body":"SDAS输入数据格式描述h5ad文件：为anndata对象 rds文件： 为Seurat v4 assay对象 SDAS输入数据格式描述 用户可以直接使用SAW生成的单片或多片空间转录组表达矩阵，也可以按照如下h5ad和rds格式说明自行准备文件，作为SDAS的输入。更多细节格式描述可参考各模块使用说明。 h5ad文件：为anndata对象 原始表达矩阵: 可存在adata.layers（在SDAS命令行中通过--layer参数来指定key）， 或者存在adata.raw.X, adata.X 基因名（即gene symbol）：可存在adata.var[\"real_gene_name\"]，或adata.var的其他列（在SDAS命令行中通过--gene_symbol_key来指定key） 空间坐标（x,y） ：存在adata.obsm[\"spatial\"] ，用于scanpy.pl.spatial()绘制空间图或者参与空间距离计算。坐标系需符合SAW软件的标准输出格式，单位为时空芯片的像素。 空间坐标示例（Stereo-seq数据，bin100分辨率）： ```python print(adata.obsm[\"spatial\"]) # 输出格式：[x坐标, y坐标] [[100 7900] # 第一个空间点的坐标 [100 8000] # 第二个空间点的坐标 [100 8100] # 第三个空间点的坐标 ... [20200 18800] # 倒数第三个空间点的坐标 [20200 18900] # 倒数第二个空间点的坐标 [20200 19000]] # 最后一个空间点的坐标 ``` rds文件： 为Seurat v4 assay对象 原始表达矩阵: 存在默认assay的counts中(如@assays$RNA@counts)，或者在SDAS中通过--assay指定assay名 基因名（即gene symbol）： 可存在meta.features[“real_gene_name”]，或meta.features的其他列（在SDAS中通过--gene_symbol_key来指定key） 空间坐标（x,y）：存在@reductions$spatial中，用于FeaturePlot(reduction=“spatial”），DimPlot(reduction = “spatial”) 画空间图 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/sdas_test_data.html":{"url":"readme/04_manual/sdas_test_data.html","title":"性能测试环境和数据描述","keywords":"","body":"性能测试环境和数据描述性能测试环境和数据描述 对功能模块进行性能测试，包括运行时间和使用内存峰值。 测试环境：研发内部集群（实际生产环境），CPU节点计算资源为112个CPU、1T内存，GPU节点为112个CPU, 2T内存，16G显存。 测试数据：研发内部数据，包括小鼠样本和病理样本，Stereo-seq V1.3和FFPE各5例，每个模块测试使用样本为10例中的子集。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/dataprocess/":{"url":"readme/04_manual/dataprocess/","title":"数据处理","keywords":"","body":"数据处理数据处理 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/dataprocess/01_intro.html":{"url":"readme/04_manual/dataprocess/01_intro.html","title":"简介","keywords":"","body":"简介简介 数据处理模块（dataProcess）用于对SAW生成的h5ad文件进行多片合并、格式转换、adata信息打印及子集提取等操作，支持h5ad、h5mu、csv等多种输入格式，便于下游分析。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/dataprocess/02_input.html":{"url":"readme/04_manual/dataprocess/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例表达矩阵文件格式说明输入文件示例 表达矩阵文件格式说明 st.h5ad：SAW生成的单片或多片空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、空间坐标等信息。具体请参考SDAS输入数据格式描述。 st.h5mu：SAW aggr输出的多模态数据文件，可通过h5mu2h5ad转换为h5ad。 mult.csv：多片合并时的输入文件。 首行以#开头为表头，内容包括样本名、分组信息、h5ad绝对路径，以逗号分隔，示例内容如下： 合并后的adata文件中，样本和分组信息分别存于adata.obs['sampleID']和adata.obs['group'] #sample,group,path sample1,groupA,sample1.h5ad.path sample2,groupB,sample2.h5ad.path © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/dataprocess/03_function.html":{"url":"readme/04_manual/dataprocess/03_function.html","title":"运行命令说明","keywords":"","body":"运行命令说明用途与运行方式mergeAdata: 多片h5ad合并h5ad2rds: h5ad转rdsh5mu2h5ad: h5mu转h5adprintAdataInfo: 打印adata信息subsetAdata: h5ad子集提取输入参数说明输出结果展示运行命令说明 用途与运行方式 mergeAdata: 多片h5ad合并 将多个h5ad文件合并为一个h5ad文件 SDAS dataProcess mergeAdata -i mult.csv -o outdir h5ad2rds: h5ad转rds 将h5ad格式数据转换为rds格式 SDAS dataProcess h5ad2rds -i st.h5ad --run_mode stRNA -o outdir h5mu2h5ad: h5mu转h5ad 将h5mu格式数据转换为h5ad格式 SDAS dataProcess h5mu2h5ad -i st.h5mu -o outdir printAdataInfo: 打印adata信息 输出h5ad文件的详细信息到shell或指定目录 SDAS dataProcess printAdataInfo -i st.h5ad -o outdir SDAS dataProcess printAdataInfo -i st.h5ad subsetAdata: h5ad子集提取 根据指定条件提取h5ad的子集，支持数值区间或列表筛选 数值筛选： SDAS dataProcess subsetAdata -i st.h5ad --label_key total_counts -o outdir \\ --min 100 --max 5000 列表筛选： SDAS dataProcess subsetAdata -i st.h5ad --label_key anno_spotlight -o outdir \\ --list_include B,Fibroblast 输入参数说明 参数 是否必须 说明 -i / --input 是 输入文件，支持h5ad、h5mu、csv（mergeAdata进行多片合并时，输入为csv，首行为表头） --label_key 是 subsetAdata时使用，提取adata子集指定的obs或者var的列名 -o / --output 否 输出文件夹，printAdataInfo不加-o时，将adata信息输出到shell --run_mode 否 h5ad2rds时使用，输入数据类型，stRNA或scRNA，默认为stRNA --gene_symbol_key 否 mergeAdata时使用，指定h5ad.var中基因名的列名（_index表示用h5ad.var.index） --layer 否 h5ad2rds和subsetAdata时使用，指定h5ad存储raw counts的layer层 --list_include 否 subsetAdata时使用，label_key为列表时需提取的元素，如Fibroblast,B,NK --list_exclude 否 subsetAdata时使用，label_key为列表时不需提取的元素 --min 否 subsetAdata时使用，label_key为数值时的最小值 --max 否 subsetAdata时使用，label_key为数值时的最大值 输出结果展示 结果文件 说明 .h5ad h5mu转换的h5ad _subset.h5ad subsetAdata得到的子集h5ad combine.h5ad 多片合并后的h5ad .rds h5ad转换的rds文件 _adata_info.txt adata的详细信息 adata的详细信息_adata_info.txt 该文件用于快速了解AnnData对象的结构、包含哪些主要信息，以及标签的分布情况。文件主要输出以下几类信息： AnnData对象的基本维度（观测数n_obs × 特征数n_vars） obs（观测/样本）和var（特征/基因）包含的字段名称 uns、obsm、layers、obsp等存储的分析结果或元数据类型 obs和var的列数统计, obs_names和var_names的前5个值 obs中每个分类字段的唯一值数量和具体取值（如leiden聚类标签、样本信息等） AnnData object with n_obs × n_vars = 120 × 32577 obs: 'total_counts', 'n_genes_by_counts', 'pct_counts_mt', 'leiden', 'orig.ident', 'x', 'y' var: 'real_gene_name', 'n_cells', 'n_counts', 'mean_counts', 'mean', 'dispersions', 'dispersions_norm', 'highly_variable' uns: 'bin_size', 'bin_type', 'gene_leiden', 'mt', 'leiden_resolution', 'neighbors', 'omics', 'pca_variance_ratio', 'rank_genes_groups', 'resolution' obsm: 'spatial' layers: 'raw_counts' obsp: 'connectivities', 'distances' The 'obs' attribute of the AnnData contains 7 columns. The 'var' attribute of the AnnData contains 6 columns. Top 5 cell names: Index(['56032143344836', '56027848377591', '56006373541090', '55941949031633', '55937654064316'], dtype='object') Top 5 gene names: Index(['ENSG00000000003', 'ENSG00000000005', 'ENSG00000000419', 'ENSG00000000457', 'ENSG00000000460'], dtype='object') Top 5 real_gene_name: ['TSPAN6', 'TNMD', 'DPM1', 'SCYL3', 'C1orf112'] Number of unique values in each column of 'obs' (except 'total_counts', 'n_genes_by_counts', 'pct_counts_mt', 'x', 'y') leiden: 8 unique values orig.ident: 1 unique values Unique values in each column of 'obs': ************************************************** leiden: Index(['10', '11', '12', '13', '14', '15', '16', '17'], dtype='object') ************************************************** orig.ident: Index(['sample1'], dtype='object') ************************************************** © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/":{"url":"readme/04_manual/cell_annotation/","title":"细胞类型注释","keywords":"","body":"细胞类型注释细胞类型注释 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/01_intro.html":{"url":"readme/04_manual/cell_annotation/01_intro.html","title":"简介","keywords":"","body":"简介算法测评经验模块算法整体介绍参考文献简介 ​​细胞注释旨在通过分析细胞的基因表达谱，将细胞准确分类并确定其生物学身份 (如细胞类型、状态或亚群)，从而解读数据的生物学意义、揭示组织或样本的细胞组成和功能异质性，并为包括细胞邻域分析、CNV分析、细胞通讯分析、轨迹分析、细胞空间距离关系分析、差异基因分析、转录因子分析在内的多种下游分析提供分类基础。​ 算法测评经验 如果希望快速获得结果，建议首先尝试使用Tangram或RCTD，对于没有单细胞参考的人类样本也可以先尝试SCimilarity。如果需要更准确的注释结果且有GPU资源，建议使用cell2location。详细算法测评信息，请参考此链接。 算法 性能 内存 时间 GPU 加速 cell2location ⭐⭐⭐⭐⭐ ⭐⭐ ⭐ 无 GPU 时极其慢 RCTD ⭐⭐⭐⭐（排除未注释细胞） ⭐⭐⭐ ⭐⭐⭐ Tangram ⭐⭐⭐ ⭐⭐⭐⭐ ⭐⭐⭐⭐ CPU上速度较快，且可用 GPU加速 SPOTlight ⭐⭐ ⭐ ⭐⭐ SCimilarity ⭐ ⭐⭐⭐⭐⭐ ⭐⭐⭐⭐⭐ CPU上速度很快。可用 GPU加速，但效果不明显 模块算法整体介绍 参考文献 Biancalani, T., Scalia, G., Buffoni, L., Avasthi, R., Lu, Z., Sanger, A., ... & Regev, A. (2021). Deep learning and alignment of spatially resolved single-cell transcriptomes with Tangram. Nature methods, 18(11), 1352-1362. Cable, D. M., Murray, E., Zou, L. S., Goeva, A., Macosko, E. Z., Chen, F., & Irizarry, R. A. (2022). Robust decomposition of cell type mixtures in spatial transcriptomics. Nature biotechnology, 40(4), 517-526. Elosua-Bayes, M., Nieto, P., Mereu, E., Gut, I., & Heyn, H. (2021). SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes. Nucleic acids research, 49(9), e50-e50. Heimberg, G., Kuo, T., DePianto, D. J., Salem, O., Heigl, T., Diamant, N., ... & Regev, A. (2025). A cell atlas foundation model for scalable search of similar human cells. Nature, 638(8052), 1085-1094. Kleshchevnikov, V., Shmatko, A., Dann, E., Aivazidis, A., King, H. W., Li, T., ... & Bayraktar, O. A. (2022). Cell2location maps fine-grained cell types in spatial transcriptomics. Nature biotechnology, 40(5), 661-671. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/02_input.html":{"url":"readme/04_manual/cell_annotation/02_input.html","title":"h5ad数据格式说明","keywords":"","body":"h5ad数据格式说明输入h5ad格式说明输出h5ad格式说明h5ad数据格式说明 输入h5ad格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、基因名、空间坐标等信息。具体请参考SDAS输入数据格式描述。多片空转数据可以提供自定义的slice_key，默认为'sampleID'，用于画图 (在cell2location中也用于提供批次信息)。如果不提供，则当做单片处理。 sc.h5ad：单细胞表达矩阵AnnData对象，要求包含原始表达矩阵、基因名等信息。具体请参考SDAS输入数据格式描述。同时单细胞obs中要有注释信息，存在自定义的label_key中; RCTD算法不支持注释信息有‘/’的情况。 SCimilarity算法只适用于人类样本。 输出h5ad格式说明 输入h5ad+注释结果：每个细胞类型的分数存在obsm['anno_score_']中，分数最高的类型存在obs['anno_']中。算法的其他输出结果和中间文件没有保存。 未被注释的细胞的类型统一为NA。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/03_cell2location/":{"url":"readme/04_manual/cell_annotation/03_cell2location/","title":"cell2location算法","keywords":"","body":"cell2location算法cell2location算法 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/03_cell2location/01_ref.html":{"url":"readme/04_manual/cell_annotation/03_cell2location/01_ref.html","title":"构建单细胞参考数据","keywords":"","body":"构建单细胞参考数据用途运行方式输入参数说明输出结果展示构建单细胞参考数据 用途 使用cell2locationMakeRef构建cell2location的单细胞参考inf_aver.csv文件 运行方式 SDAS cellAnnotation cell2locationMakeRef -o ./ref --reference sc.h5ad --label_key annotation \\ --batch_key id \\ --nonz_mean_cutoff 1.45 \\ --gpu_id 3 输入参数说明 参数是否必须默认值描述-o / --output是输出文件夹--reference是单细胞ref h5ad，要求有原始表达矩阵--label_key是单细胞ref h5ad.obs中表示细胞类型的列的名称--ref_layer否单细胞ref h5ad存放raw counts的layer--ref_gene_symbol_key否_index单细胞ref h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index)--batch_key否单细胞ref h5ad.obs中表示批次的列的名称，不输入则不考虑批次--filter_rare_cell否100如果某些细胞类型在单细胞ref中细胞数小于此值，则过滤掉这些细胞类型--check_filter_genes否如果设置此参数，则只输出筛选基因的结果图filter_genes.png--cell_count_cutoff否5控制cell2location筛选基因的参数，一般不调整--cell_percentage_cutoff2否0.03控制cell2location筛选基因的参数，值越大筛选出的基因越少，基因数推荐控制在8k-16k--nonz_mean_cutoff否1.12控制cell2location筛选基因的参数，值越大筛选出的基因越少，基因数推荐控制在8k-16k--max_epochs否250模型训练epoch数--seed否42随机种子设置--gpu_id否-1使用的GPU的编号，如果为-1，则使用CPU。 此参数只指定主要使用的GPU，其他GPU也会被占用，但占用量很低。如果需要严格指定GPU，请在运行前设置环境变量，如: export CUDA_VISIBLE_DEVICES=2，此时再设置--gpu_id 0，则会只使用2号GPU--n_threads否CPU模式下使用的线程数，默认为全部CPU 输出结果展示 结果文件 描述 _filter_genes.png/pdf Cell2location筛选基因的结果图 (\\为单细胞ref h5ad文件名) _train_history.png/pdf 训练Loss下降图 _inf_aver.csv Cell2location构建的单细胞ref csv Cell2location筛选基因的结果图：_filter_genes.png/pdf橙色区域标出了根据表达该基因的细胞数 (Y轴) 和该基因在被检测到的细胞中的平均RNA计数 (X轴) 共同筛选后被排除的基因。图片标题中的基因数为筛选出的基因数，推荐控制在8k-16k 训练Loss下降图：_train_history.png/pdf训练过程中ELBO loss的变化曲线，图中已去除前20个epoch的数据 Cell2location构建的单细胞ref csv：_inf_aver.csv每一行为一个基因，每一列为一个细胞类型，数值为cell2location计算的细胞类型特征 (用负二项回归模型计算的每个细胞类型每个基因的预估表达量) B_act B_naive CD4_CXCL13 ... 7SK 0.3071783 0.22791654 0.059129756 ... A1BG 0.18173707 0.096046284 0.0936929 ... A1BG-AS1 0.04608244 0.042425267 0.08740552 ... A1CF 0.00167472 0.000960604 0.002093679 ... ... ... ... ... ... © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/03_cell2location/02_anno.html":{"url":"readme/04_manual/cell_annotation/03_cell2location/02_anno.html","title":"细胞注释","keywords":"","body":"细胞注释用途运行方式输入参数说明输出结果展示细胞注释 用途 使用cell2location做解卷积细胞注释 运行方式 SDAS cellAnnotation cell2location -i st.h5ad -o outdir --reference_csv ./ref/inf_aver.csv \\ --bin_size 20 \\ --input_gene_symbol_key _index \\ --gpu_id 3 输入参数说明 参数是否必须默认值描述-i / --input是Stereo-seq h5ad，要求有原始表达矩阵-o / --output是输出文件夹--reference_csv是单细胞ref csv文件--bin_size是Bin大小，用于控制每个bin的细胞数和图中点的大小; 如20, 50, 100, cellbin (等效于20)--input_layer否Stereo-seq h5ad存放raw counts的layer--input_gene_symbol_key否real_gene_nameStereo-seq h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index)--slice_key否sampleID多片h5ad.obs中表示片编号的列的名称，提供批次信息和用于画图--detection_alpha否20规则化参数。空转数据的技术性变异越大，适合的detection_alpha越小，一般不调整--data_split_strategy否chunk当bin数量太大时，对空转数据进行拆分，此参数为数据拆分策略。chunk表示先随机拆分再运行cell2location，batch表示在算法内部进行拆分--data_split_size否10000当bin数量太大时，对空转数据进行拆分，此参数为拆分的数据大小。越大运行得越快，但所占显存也越大。如果为-1，则不进行拆分--max_epochs否5000模型训练epoch数--seed否42随机种子设置--gpu_id否-1使用的GPU的编号，如果为-1，则使用CPU。 此参数只指定主要使用的GPU，其他GPU也会被占用，但占用量很低。如果需要严格指定GPU，请在运行前设置环境变量，如: export CUDA_VISIBLE_DEVICES=2，此时再设置--gpu_id 0，则会只使用2号GPU--n_threads否CPU模式下使用的线程数，默认为全部CPU 输出结果展示 结果文件 描述 _anno_cell2location.csv 每个spot的注释结果，包括每种细胞类型的分数（分数来源于cell2location计算的q05_cell_abundance_w_sf） _anno_cell2location.h5ad 输入h5ad+注释结果。每个细胞类型的分数存在obsm['anno_score_cell2location']中，分数最高的类型存在obs['anno_cell2location']中 _anno_cell2location.png/pdf 总体注释结果图，多片情况下每片画一张图，同时输出png和pdf _anno_cell2location_split.png/pdf 每个细胞类型分开展示图，多片情况下每片画一张图，同时输出png和pdf _anno_score_cell2location.png/pdf 每个细胞类型的分数图，多片情况下每片画一张图，同时输出png和pdf 总体注释结果图: _anno_cell2location.png/pdf颜色代表每个bin/cellbin的占比最高的细胞类型 细胞类型分开展示结果图: _anno_cell2location_split.png/pdf颜色代表每个bin/cellbin的占比最高的细胞类型，标题为细胞类型（细胞个数） 细胞类型分数图: _anno_score_cell2location.png/pdf算法计算的不同细胞类型的分数。分数越高，该细胞类型占比越高 注释结果csv: _anno_cell2location.csv每一行为一个bin/cellbin，每一列为一个细胞类型，数值为细胞类型分数，分数越高，该细胞类型占比越高。最后一列 (annotation) 为此bin/cellbin中占比最高的细胞类型 index B_act B_naive CD4_CXCL13 ... annotation CRCP95_T_BIN.242 0.1689 0.1694 0.2176 ... CAF_CXCL14 CRCP95_T_BIN.243 0.1122 0.2350 0.1745 ... Epi CRCP95_T_BIN.244 0.1020 0.2062 0.1527 ... Epi CRCP95_T_BIN.245 0.0808 0.1980 0.1668 ... Epi ... ... ... ... ... ... © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/04_rctd.html":{"url":"readme/04_manual/cell_annotation/04_rctd.html","title":"RCTD算法","keywords":"","body":"RCTD算法用途运行方式输入参数说明输出结果展示RCTD算法 用途 使用RCTD做解卷积细胞注释 运行方式 SDAS cellAnnotation rctd -i st.h5ad -o outdir --reference sc.h5ad --bin_size 20 --label_key annotation2 \\ --filter_rare_cell 0 输入参数说明 参数是否必须默认值描述-i / --input是Stereo-seq h5ad，要求有原始表达矩阵-o / --output是输出文件夹--reference是单细胞ref h5ad，要求有原始表达矩阵--label_key是单细胞ref h5ad.obs中表示细胞类型的列的名称--bin_size是Bin大小，用于控制图中点的大小，不用于计算,比如20,50,100, cellbin (等效于20)--input_layer否Stereo-seq h5ad存放raw counts的layer--ref_layer否单细胞ref h5ad存放raw counts的layer--input_gene_symbol_key否real_gene_nameStereo-seq h5ad.var中表示基因名(symbol)的列的名称--ref_gene_symbol_key否_index单细胞ref h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index)--slice_key否sampleID多片h5ad.obs中表示片编号的列的名称，用于画图--filter_rare_cell否100如果某些细胞类型在单细胞ref中细胞数小于此值，则过滤掉这些细胞类型--mode否fullRCTD模式。选项：doublet, multi, full--UMI_min否100小于此UMI数的空转spot会被过滤--counts_MIN否10小于此基因数的空转spot会被过滤--seed否42随机种子设置--n_cpus否8使用的进程数 输出结果展示 结果文件 描述 _anno_rctd.csv 每个spot的注释结果，包括每种细胞类型的分数 _anno_rctd.h5ad 输入h5ad+注释结果。每个细胞类型的分数存在obsm['anno_score_rctd']中，分数最高的类型存在obs['anno_rctd']中 _anno_rctd.png/pdf 总体注释结果图，多片情况下每片画一张图，同时输出png和pdf _anno_rctd_split.png/pdf 每个细胞类型分开展示图，多片情况下每片画一张图，同时输出png和pdf _anno_score_rctd.png/pdf 每个细胞类型的分数图，多片情况下每片画一张图，同时输出png和pdf 详细说明与具体结果展示可参考以下链接。(cell2location算法-->细胞注释-->输出结果展示)。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/05_tangram.html":{"url":"readme/04_manual/cell_annotation/05_tangram.html","title":"Tangram算法","keywords":"","body":"Tangram算法用途运行方式输入参数说明输出结果展示Tangram算法 用途 使用Tangram做细胞注释 运行方式 SDAS cellAnnotation tangram -i st.h5ad -o outdir --reference sc.h5ad --bin_size 20 --label_key annotation2 \\ --filter_rare_cell 0 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --reference 是 单细胞ref h5ad，要求有原始表达矩阵 --label_key 是 单细胞ref h5ad.obs中表示细胞类型的列的名称 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算,比如20,50,100, cellbin (等效于20) --input_layer 否 Stereo-seq h5ad存放raw counts的layer --ref_layer 否 单细胞ref h5ad存放raw counts的layer --input_gene_symbol_key 否 real_gene_name Stereo-seq h5ad.var中表示基因名(symbol)的列的名称 --ref_gene_symbol_key 否 _index 单细胞ref h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index) --slice_key 否 sampleID 多片h5ad.obs中表示片编号的列的名称，用于画图 --filter_rare_cell 否 100 如果某些细胞类型在单细胞ref中细胞数小于此值，则过滤掉这些细胞类型 --max_epochs 否 1000 模型训练epoch数 --top_markers 否 200 用于Tangram计算的每个细胞类型的marker基因数量 --seed 否 42 随机种子设置 --gpu_id 否 -1 使用的GPU的编号，如果为-1，则使用CPU --n_threads 否 CPU模式下使用的线程数，默认为全部CPU 输出结果展示 结果文件 描述 _anno_tangram.csv 每个spot的注释结果，包括每种细胞类型的分数 _anno_tangram.h5ad 输入h5ad+注释结果。每个细胞类型的分数存在obsm['anno_score_tangram']中，分数最高的类型存在obs['anno_tangram']中 _anno_tangram.png/pdf 总体注释结果图，多片情况下每片画一张图，同时输出png和pdf _anno_tangram_split.png/pdf 每个细胞类型分开展示图，多片情况下每片画一张图，同时输出png和pdf _anno_score_tangram.png/pdf 每个细胞类型的分数图，多片情况下每片画一张图，同时输出png和pdf 详细说明与具体结果展示可参考以下链接。(cell2location算法-->细胞注释-->输出结果展示)。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/06_scimilarity/":{"url":"readme/04_manual/cell_annotation/06_scimilarity/","title":"SCimilarity算法","keywords":"","body":"SCimilarity算法SCimilarity算法 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/06_scimilarity/01_ref.html":{"url":"readme/04_manual/cell_annotation/06_scimilarity/01_ref.html","title":"构建单细胞参考数据 (非必须)","keywords":"","body":"构建单细胞参考数据 (非必须)用途运行方式输入参数说明输出结果展示构建单细胞参考数据 (非必须) 用途 使用scimilarityMakeRef构建SCimilarity的单细胞参考数据库，只适用于人类样本 运行方式 模型下载：https://zenodo.org/records/10685499 下载完成后解压模型文件夹，并指定--model_dir参数 SDAS cellAnnotation scimilarityMakeRef -o ./scimilarity_ref --reference sc.h5ad --label_key annotation \\ --model_dir ./model_v1.1 \\ --remove_tmp 输入参数说明 参数 是否必须 默认值 描述 -o / --output 是 输出文件夹 --reference 是 单细胞ref h5ad，要求有原始表达矩阵 --label_key 是 单细胞ref h5ad.obs中表示细胞类型的列的名称 --ref_layer 否 单细胞ref h5ad存放raw counts的layer --ref_gene_symbol_key 否 _index 单细胞ref h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index) --filter_rare_cell 否 100 如果某些细胞类型在单细胞ref中细胞数小于此值，则过滤掉这些细胞类型 --seed 否 42 随机种子设置 --model_dir 否 ./model_v1.1 SCimilarity模型文件夹路径 --ef_construction 否 1000 HNSW KNN算法的ef_construction，越大构建的数据库越准确，但是更耗时 --M 否 80 HNSW KNN算法M，用于控制nearest neighbor图中的连接数 --remove_tmp 否 False 是否删除ouput文件夹中的单细胞ref CellArrDataset格式数据和模型计算出的embeddings。注意：ouput文件夹中原本的assays、cell_metadata、gene_annotation、sample_metadata、cellsearch文件夹都会被删除 --gpu_id 否 -1 使用的GPU的编号，如果为-1，则使用CPU --n_threads 否 CPU模式下使用的线程数，默认为全部CPU 输出结果展示 构建的单细胞参考数据会存储在scimilarity_ref 的文件夹下，具体的文件夹层级结构以及关键文件的说明如下： ./scimilarity_ref ├── annotation │ ├── labelled_kNN.bin │ └── reference_labels.tsv ├── assays ├── cell_metadata ├── cellsearch │ └── cell_embedding ├── gene_annotation └── sample_metadata 结果文件 描述 annotation/labelled_kNN.bin 通过单细胞ref embeddings计算的KNN数据，用于细胞类型搜索 annotation/reference_labels.tsv 单细胞ref中每个细胞的细胞类型标签 assays, cell_metadata, gene_annotation, sample_metadata 单细胞ref h5ad转换出的CellArrDataset格式数据，可删除。可通过--remove_tmp在程序运行结束时自动删除 cellsearch/cell_embedding 模型计算出的单细胞ref embeddings tileDB格式数据，可删除。可通过--remove_tmp在程序运行结束时自动删除 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/06_scimilarity/02_anno.html":{"url":"readme/04_manual/cell_annotation/06_scimilarity/02_anno.html","title":"细胞注释","keywords":"","body":"细胞注释用途运行方式输入参数说明输出结果展示细胞注释 用途 使用SCimilarity做细胞注释，只适用于人类样本 运行方式 模型下载：https://zenodo.org/records/10685499 下载完成后解压模型文件夹，并指定--model_dir参数 使用预构建的数据库（建议添加--cell_type_file参数指定需要注释细胞类型，可用的细胞类型参见模型文件夹中的label_ints.csv）： SDAS cellAnnotation scimilarity -i st.h5ad -o outdir --bin_size 20 \\ --model_dir ./model_v1.1 \\ --cell_type_file celltype.txt 使用scimilarityMakeRef构建的单细胞参考数据库： SDAS cellAnnotation scimilarity -i st.h5ad -o outdir --bin_size 20 \\ --model_dir ./model_v1.1 --reference_database scimilarity_ref 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算,比如20,50,100, cellbin (等效于20) --input_layer 否 Stereo-seq h5ad存放raw counts的layer --input_gene_symbol_key 否 real_gene_name Stereo-seq h5ad.var中表示基因名(symbol)的列的名称 --slice_key 否 sampleID 多片h5ad.obs中表示片编号的列的名称，用于画图 --model_dir 否 ./model_v1.1 Scimilarity模型文件夹路径 --reference_database 否 用scimilarityMakeRef构建的单细胞数据库路径。如果不指定，则使用\\中预构建的数据库 --cell_type_file 否 需要注释的细胞类型文件，每行一个细胞类型。如果不提供则使用模型中的所有细胞类型。可用的细胞类型参见模型文件夹中的label_ints.csv --k_nearest_neighbor 否 50 搜索最近的K个细胞 --ef 否 100 HNSW KNN算法的ef。ef越大搜索越准确，但是更耗时 --weighting 否 False 是否使用最近K个细胞的距离加权值而不是原始个数值作为细胞注释的结果 --seed 否 42 随机种子设置 --gpu_id 否 -1 使用的GPU的编号，如果为-1，则使用CPU --n_threads 否 CPU模式下使用的线程数，默认为全部CPU 输出结果展示 结果文件 描述 _anno_scimilarity.csv 每个spot的注释结果，包括每种细胞类型的分数 _anno_scimilarity.h5ad 输入h5ad+注释结果。每个细胞类型的分数存在obsm['anno_score_scimilarity']中，分数最高的类型存在obs['anno_scimilarity']中 _anno_scimilarity.png/pdf 总体注释结果图，多片情况下每片画一张图，同时输出png和pdf _anno_scimilarity_split.png/pdf 每个细胞类型分开展示图，多片情况下每片画一张图，同时输出png和pdf _anno_score_scimilarity.png/pdf 每个细胞类型的分数图，多片情况下每片画一张图，同时输出png和pdf 详细说明与具体结果展示可参考以下链接。(cell2location算法-->细胞注释-->输出结果展示)。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/07_spotlight.html":{"url":"readme/04_manual/cell_annotation/07_spotlight.html","title":"SPOTlight算法","keywords":"","body":"SPOTlight算法用途运行方式输入参数说明输出结果展示SPOTlight算法 用途 使用SPOTlight做解卷积细胞注释 运行方式 SDAS cellAnnotation spotlight -i st.h5ad -o outdir --reference sc.h5ad --bin_size 20 --label_key annotation2 \\ --input_gene_symbol_key _index 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --reference 是 单细胞ref h5ad，要求有原始表达矩阵 --label_key 是 单细胞ref h5ad.obs中表示细胞类型的列的名称 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算,比如20,50,100, cellbin (等效于20) --input_layer 否 Stereo-seq h5ad存放raw counts的layer --ref_layer 否 单细胞ref h5ad存放raw counts的layer --input_gene_symbol_key 否 real_gene_name Stereo-seq h5ad.var中表示基因名(symbol)的列的名称 --ref_gene_symbol_key 否 _index 单细胞ref h5ad.var中表示基因名(symbol)的列的名称 (_index 表示使用h5ad.var.index) --slice_key 否 sampleID 多片h5ad.obs中表示片编号的列的名称，用于画图 --filter_rare_cell 否 100 如果某些细胞类型在单细胞ref中细胞数小于此值，则过滤掉这些细胞类型 --n_cells 否 100 单细胞ref中每个细胞类型随机选取的细胞数，用于训练spotlight模型 --n_hvg 否 3000 单细胞ref中的高变基因个数，高变基因和marker基因共同作为基因集 --auc_threshold 否 0.5 用于过滤单细胞ref中每个细胞类型marker基因的AUC阈值，高变基因和marker基因共同作为基因集 --norm_sc 否 False 是否用logNormCounts函数处理单细胞ref数据 --norm_sp 否 False 是否用logNormCounts函数处理Stereo-seq数据 --seed 否 42 指定随机种子 --n_threads 否 8 使用的线程数 输出结果展示 结果文件描述_anno_spotlight.csv每个spot的注释结果，包括每种细胞类型的分数_anno_spotlight.h5ad输入h5ad+注释结果。每个细胞类型的分数存在obsm['anno_score_spotlight']中，分数最高的类型存在obs['anno_spotlight']中_anno_spotlight.png/pdf总体注释结果图，多片情况下每片画一张图，同时输出png和pdf_anno_spotlight_split.png/pdf每个细胞类型分开展示图，多片情况下每片画一张图，同时输出png和pdf_anno_score_spotlight.png/pdf每个细胞类型的分数图，多片情况下每片画一张图，同时输出png和pdf 详细说明与具体结果展示可参考以下链接。(cell2location算法-->细胞注释-->输出结果展示)。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_annotation/08_performence.html":{"url":"readme/04_manual/cell_annotation/08_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 性能测试使用n_cpus或n_threads=24，GPU为NVIDIA T4 16G 运行时间：cell2location > spotlight > RCTD > tangram > scimilarity 内存：spotlight > cell2location > RCTD/tangram/scimilarity cell2location/spotlight内存需求与细胞数量呈显著正相关，RCTD/Tangram/scimilarity内存需求在不同大小的数据上比较一致 GPU使用情况：cell2location所有bin size都可以在16G显存的GPU上运行；tangram bin100和bin50在GPU上运行，cellbin和bin20在CPU上运行；scimilarity所有bin size都可以在16G显存的GPU上运行，使用CPU和GPU在运行时间上无显著差别 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_domain/":{"url":"readme/04_manual/spatial_domain/","title":"空间结构域识别","keywords":"","body":"空间结构域识别空间结构域识别 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_domain/01_intro.html":{"url":"readme/04_manual/spatial_domain/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 空间结构域指的是组织切片上具有特定基因表达模式的区域，这些区域通常在空间上连续，并且表现出一定的功能一致性。通过识别结构域，研究人员可以更好地了解组织内的细胞如何相互作用以及它们如何协同工作来执行复杂的生物学过程，并为差异基因分析提供分类基础。 参考文献 Long, Y., Ang, K. S., Li, M., Chong, K. L. K., Sethi, R., Zhong, C., ... & Chen, J. (2023). Spatially informed clustering, integration, and deconvolution of spatial transcriptomics with GraphST. Nature Communications, 14(1), 1155. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_domain/02_input.html":{"url":"readme/04_manual/spatial_domain/02_input.html","title":"h5ad数据格式说明","keywords":"","body":"h5ad数据格式说明输入h5ad格式说明输出h5ad格式说明h5ad数据格式说明 输入h5ad格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、空间坐标等信息。具体请参考SDAS输入数据格式描述。 输出h5ad格式说明 输入h5ad+结构域识别结果：结构域标签存在obs['domain_']中 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_domain/03_graphst.html":{"url":"readme/04_manual/spatial_domain/03_graphst.html","title":"graphST算法","keywords":"","body":"graphST算法运行方式输入参数说明输出结果展示graphST算法 运行方式 SDAS spatialDomain graphst –i st.h5ad –o outdir --n_clusters 10 --bin_size 100 \\ --gpu_id 1 --n_hvg 3000 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --n_clusters 是 聚类数目 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算,比如20,50,100, cellbin (等效于20) --tool 否 mclust Graphst所选的聚类方法，可选'mclust', 'leiden', louvain' --layer 否 指定Stereo-seq h5ad存放raw counts的layer --n_hvg 否 3000 使用的高变基因数 --slice_key 否 多片h5ad.obs中表示片编号的列的名称，如果是多片，必须指定* --gpu_id 否 -1 使用的GPU的编号，如果为-1，则使用CPU --seed 否 42 随机种子设置 *符合下列情况，可以进行多片分析： 邻片，组织纵向切片，做空间域分析前，需要进行邻片配准，参数slice_key设置为h5ad的obs中记录多片的key。 同一个组织切片，在水平方向上分成若干连续多片，分开测序，需要多片在水平方向上配准。 具体可参考： https://deepst-tutorials.readthedocs.io/en/latest/Tutorial%204\\_Horizontal%20Integration.html （邻片） https://deepst-tutorials.readthedocs.io/en/latest/Tutorial%205\\_Vertical%20Integration.html （水平方向） 输出结果展示 结果文件 描述 _domain_graphst.h5ad 输入h5ad+空间域聚类结果，聚类结果保存在obs['domain_graphst']中 _domain_graphst.png/pdf 空间域cluster在组织上的分布图，同时输出png和pdf _domain_graphst_split.png/pdf 空间域不同cluster分开展示的图，同时输出png和pdf 空间域cluster在组织上的分布图：_domain_graphst.png/pdf颜色代表每个bin/cellbin的空间结构域类型 空间域cluster在组织上分开的分布图: _domain_graphst_split.png/pdf颜色代表每个bin/cellbin的空间结构域类型，标题为空间结构域类型（细胞个数） © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_domain/xing-neng-ce-shi.html":{"url":"readme/04_manual/spatial_domain/xing-neng-ce-shi.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 CPU模式： GraphST算法支持并行运算，但无法通过参数控制线程数，该性能测试是在测试节点计算资源112个CPU、1T内存的条件下进行的测试。运行时间和内存与细胞数量呈现正相关 GPU模式：GPU为NVIDIA T4 16G，若cell数量不超过4.9万个时，能够正常完成测试，且运行时间与细胞数量呈现正相关。 Cellbin/Bin20时，CPU或者GPU模式下均不能完成测试，因需求内存过大，导致程序运行失败。 备注：GPU模式下，16G显存时，细胞数量大于4.6万且小于4.9万时，可以通过设置export PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512能够跑通，小于4.6万时，无需设置即能跑通 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_neighborhood/":{"url":"readme/04_manual/cell_neighborhood/","title":"细胞邻域分析","keywords":"","body":"细胞邻域分析细胞邻域分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_neighborhood/01_intro.html":{"url":"readme/04_manual/cell_neighborhood/01_intro.html","title":"简介","keywords":"","body":"简介模块算法整体介绍参考文献简介 细胞邻域（Cellular Neighborhood, CN）分析旨在识别和表征组织中具有特定细胞组成和空间分布模式的微环境。通过对细胞邻域的分析，可以深入理解细胞间的相互作用、组织结构以及疾病状态下的微环境变化，并为差异基因分析和细胞通讯分析提供分类基础。 模块算法整体介绍 主要分为两种模式：单一细胞类型模式和细胞类型分数模式 单一细胞类型模式： 先根据每个空间点（spot）的细胞类型（如CAF、T细胞等），对每个spot划定一个邻域窗口（可以是固定半径或固定邻居数） 统计每个窗口内各种细胞类型的组成比例 基于这些细胞组成信息，对所有spot或者指定的target celltype进行聚类，识别不同的细胞邻域（CN） 细胞类型分数模式： 直接利用每个空间点的细胞类型分数（如cell2location等方法得到的每种细胞类型的丰度/概率分数） 基于这些分数矩阵，对所有spot进行聚类，识别不同的细胞邻域（CN） 参考文献 Kuppe, C., Ramirez Flores, R. O., Li, Z., Hayat, S., Levinson, R. T., Liao, X., ... & Kramann, R. (2022). Spatial multi-omic map of human myocardial infarction. Nature, 608(7924), 766-777. Liu, Y., Sinjab, A., Min, J., Han, G., Paradiso, F., Zhang, Y., ... & Wang, L. (2025). Conserved spatial subtypes and cellular neighborhoods of cancer-associated fibroblasts revealed by single-cell spatial multi-omics. Cancer cell, 43(5), 905-924. Schürch, C. M., Bhate, S. S., Barlow, G. L., Phillips, D. J., Noti, L., Zlobec, I., ... & Nolan, G. P. (2020). Coordinated cellular neighborhoods orchestrate antitumoral immunity at the colorectal cancer invasive front. Cell, 182(5), 1341-1359. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_neighborhood/02_singlecell.html":{"url":"readme/04_manual/cell_neighborhood/02_singlecell.html","title":"单一细胞类型模式","keywords":"","body":"单一细胞类型模式 用途运行方式输入参数说明输出结果展示调参建议单一细胞类型模式 用途 singleCelltype利用单一细胞类型的细胞注释结果识别和表征组织中具有特定细胞组成和空间分布模式的微环境 运行方式 SDAS cellularNeighborhood singleCelltype -i st.h5ad --bin_size 100 -o outdir --label_key anno_cell2location \\ --window_method fixed_radius 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5d，包含细胞类型注释结果 -o / --output 是 输出文件夹 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算，比如20,50,100,cellbin (等效于20) --label_key 是 h5ad.obs中表示细胞注释类型的列的名称，用于计算划窗口的细胞组成和每个CN的细胞类型neighborhood enrichment分析 --slice_key 否 多片h5ad.obs中表示片编号的列的名称，用于分片进行划窗口统计细胞组成和画图 --cluster_method 否 Kmeans 聚类方法，singleCelltype模式只能用Kmeans，multi celltype score可选择leiden或Kmeans --resolution 否 0.4 cluster_method为leiden时，leiden聚类的resolution，如果是bin20或cellbin数据，建议resolution --n_clusters 否 8 cluster_method为Kmeans时，Kmeans聚类的cluster数目 --seed 否 42 随机种子 --target_celltype 否 对特定细胞类型进行CN分析，输入细胞类型名称，有多个则以,分隔 --window_method 否 fixed_radius 划窗口的方法，fixed nearest neighbors或fixed radius --n_neighbors 否 10 以每个细胞为中心，计算其与周围n neighbors个最近邻细胞的距离，形成局部窗口 --radius 否 100 以每个细胞为中心，计算其一定半径范围(radius)内细胞的物理距离，形成局部窗口，radius为坐标距离，根据数据的分辨率可转换为物理距离，如果是stero-seq的数据，radius 100则是50um 输出结果展示 结果文件 描述 _CN.h5ad 包含细胞邻域分析结果的h5ad文件，存储了细胞邻域聚类标签和细胞组成信息全片分析时CN信息存在adata.obs[‘cell_neighbor’]target_celltype分析时，targe_celltype的CN信息存在adata.bos[‘target_CN’]邻域细胞信息存在adata.obs[‘neighbor_regions’]target_celltype和邻域细胞的分类信息存在adata.osb[‘target_CN_neighbor’] _celltype_percent_of_CN.csv 各细胞邻域中细胞类型的百分比组成 _CN_percent_of_samples.csv 多样本分析时各样本中细胞邻域的百分比组成 _celltype_percent_of_CN.png/pdf 各细胞邻域的细胞类型组成的堆叠柱状图 _CN_percent_of_samples.png/pdf 多样本时，各样本的细胞邻域组成的堆叠柱状图 _CN_umap.png/pdf 细胞邻域的umap图（cluster_method为leiden时输出） _CN_enrichment.png/pdf 细胞邻域富集热图，展示不同细胞邻域的细胞类型的富集情况 _CN_spatial.png/pdf 细胞邻域的空间分布图，多片时每片画一张图 _target_CN_neighbor_spatial.png/pdf 目标细胞和其邻域细胞的空间分布图（singleCelltype模式且指定target_celltype时生成），多片时每片画一张图 _CN_spatial_split.png/pdf 各细胞邻域分开展示的空间分布图，多片时每片画一张图 _CN_celltype_neighborhood_enrichment.png/pdf 每个细胞邻域内各细胞类型的neighborhood enrichment富集分析图 各细胞邻域中细胞类型组成的堆叠柱状图：_celltype_percent_of_CN.png/pdf 展示各细胞邻域中不同细胞类型的组成比例。横轴为细胞邻域编号，纵轴为细胞类型百分比，不同颜色代表不同细胞类型，柱状图高度表示各细胞类型在对应细胞邻域中的占比。 多样本时，各样本的细胞邻域组成的堆叠柱状图：_CN_percent_of_samples.png/pdf 展示多样本时，各样本的细胞邻域组成比例。横轴为样本名称，纵轴为细胞邻域百分比，不同颜色代表不同细胞邻域，柱状图高度表示各细胞邻域在对应样本中的占比 细胞邻域UMAP图：_CN_umap.png/pdf 展示细胞邻域在UMAP二维空间中的聚类分布（cluster_method为leiden时输出）。每个点代表一个细胞，颜色表示其所属的细胞邻域，相似细胞组成的细胞在UMAP空间中聚集在一起 细胞邻域细胞类型富集热图：_CN_enrichment.png/pdf 展示不同细胞邻域中细胞类型的富集情况。横轴为细胞类型，纵轴为细胞邻域，颜色深浅表示富集程度，红色表示富集，蓝色表示缺失 细胞邻域空间分布图：_CN_spatial.png/pdf 展示细胞邻域在组织切片上的空间分布，多片时每片画一张图。每个点代表一个细胞，颜色表示其所属的细胞邻域，相同颜色的细胞在空间上聚集形成特定的细胞邻域区域 各细胞邻域分开展示的空间分布图：_CN_spatial_split.png/pdf 分别展示每个细胞邻域在组织切片上的空间分布，多片时每片画一张图。每个子图显示一个细胞邻域的空间分布，彩色点表示属于该细胞邻域的细胞，灰色点表示其它细胞邻域，便于观察每个细胞邻域的空间分布特征 目标细胞和其邻域细胞的空间分布图：_target_CN_neighbor_spatial.png/pdf展示目标细胞和其邻域细胞在组织切片上的空间分布，多片时每片画一张图。每个点代表一个细胞，颜色表示其所属的细胞邻域，相同颜色的细胞在空间上聚集形成特定的细胞邻域区域 细胞邻域细胞类型neighborhood enrichment富集分析图：_CN_celltype_neighborhood_enrichment.png/pdf 展示每个细胞邻域内各细胞类型的neighborhood enrichment富集分析结果，横轴和纵轴为细胞类型，颜色深浅表示富集显著性 调参建议 window_method参数： fixed nearest neighbors（固定最近邻）：以每个细胞为中心，选取其空间上最近的n个邻居细胞，组成一个局部窗口。适合细胞分布密度不均匀的情况，保证每个窗口包含相同数量的细胞。 fixed radius（固定半径）：以每个细胞为中心，选取一定坐标距离（半径）范围内的所有细胞，组成一个局部窗口。适合空间尺度有明确物理意义的场景，窗口内细胞数目可变。 简言之，fixed nearest neighbors关注“邻居数量相同”，fixed radius关注“空间距离相同”。 resolution参数：cluster_method为leiden时，leiden聚类的resolution，如果是bin20或cellbin数据，建议resolution © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_neighborhood/03_multicell.html":{"url":"readme/04_manual/cell_neighborhood/03_multicell.html","title":"细胞类型分数模式","keywords":"","body":"细胞类型分数模式用途运行方式输入参数说明输出结果展示调参建议细胞类型分数模式 用途 multiCelltypeScore利用细胞类型注释的分数，比如细胞注释解卷积的分数识别和表征组织中具有特定细胞组成和空间分布模式的微环境 运行方式 SDAS cellularNeighborhood multiCelltypeScore -i st.h5ad --bin_size 100 -o outdir --score_key anno_score_cell2location \\ --label_key anno_cell2location \\ --cluster_method Kmeans 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5d，包含细胞类型注释结果 -o / --output 是 输出文件夹 --bin_size 是 Bin大小，用于控制图中点的大小，不用于计算，比如20,50,100,cellbin (等效于20) --score_key 是 h5ad.obsm中表示细胞类型score的列的名称，该数据类型必须是dataframe且有表头 --slice_key 否 多片h5ad.obs中表示片编号的列的名称，用于分片进行划窗口统计细胞组成和画图 --cluster_method 否 Kmeans 聚类方法，singleCelltype模式只能用Kmeans，multi celltype score可选择leiden或Kmeans --resolution 否 0.4 cluster_method为leiden时，leiden聚类的resolution，如果是bin20或cellbin数据，建议resolution --n_clusters 否 8 cluster_method为Kmeans时，Kmeans聚类的cluster数目 --seed 否 42 随机种子 --label_key 否 h5.obs中表示细胞注释类型的列的名称，如果指定lable_key则进行每个CN的细胞类型neighborhood enrichment分析 adata.obsm[score_key] 文件格式如下：表头为细胞类型 输出结果展示 详细说明与具体结果展示可参考以下链接。(单一细胞类型模式-->输出结果展示)。 调参建议 详细说明可参考以下链接。(单一细胞类型模式-->调参建议)。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cell_neighborhood/04_perfermence.html":{"url":"readme/04_manual/cell_neighborhood/04_perfermence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 每个样本分别用singleCelltype + Kmeans，multiCelltypeScore + Kmeans，multiCelltypeScore + leiden统计时间和内存 当细胞数目较多时（bin20数据），leiden聚类的时间和内存比较大 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cnv/":{"url":"readme/04_manual/cnv/","title":"CNV分析","keywords":"","body":"CNV分析CNV分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cnv/01_intro.html":{"url":"readme/04_manual/cnv/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 空间转录组CNV分析旨在利用inferCNV工具对空间转录组数据进行拷贝数变异（CNV）推断，帮助揭示组织中不同区域的基因组变异特征。该方法可用于识别肿瘤等组织中的异常细胞亚群，辅助空间异质性研究。 适用场景：空间转录组、单细胞转录组的CNV推断与可视化。 核心功能：推断每个spot/cell的CNV状态，输出空间热图和相关统计结果。 参考文献 Patel, A. P., Tirosh, I., Trombetta, J. J., Shalek, A. K., Gillespie, S. M., Wakimoto, H., ... & Bernstein, B. E. (2014). Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma. Science, 344(6190), 1396-1401. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cnv/02_input.html":{"url":"readme/04_manual/cnv/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例表达矩阵文件格式说明基因染色体位置文件格式说明(非必须)输入文件示例 表达矩阵文件格式说明 st.rds：空间转录组表达矩阵Seurat对象，要求包含原始表达矩阵、基因名等信息。具体请参考SDAS输入数据格式描述。多片空转数据可以提供自定义的slice_key，默认为'sampleID'，用于画图 (在cell2location中也用于提供批次信息)。如果不提供，则当做单片处理。 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含空间坐标信息，与st.rds的细胞名称（cell index）保持一致，用于空间热图绘制。具体请参考SDAS输入数据格式描述 基因染色体位置文件格式说明(非必须) --gene_order_file用户自定义基因染色体位置信息文件，可由 gtf_to_position_file.py 生成。 --species参数指定的人/小鼠的gene_order_file文件来源，行名均为gene symbol： human：GRCh38.p12- NCBI:GCA_000001405.27 mouse：GRCm38.p6-NCBI:GCA_000001635.8 Gene_symbol chr start end MIR1302-2HG 1 29554 31109 FAM138A 1 34554 36081 ... ... ... ... © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cnv/03_infercnv.html":{"url":"readme/04_manual/cnv/03_infercnv.html","title":"InferCNV算法","keywords":"","body":"InferCNV算法用途运行方式输入参数说明输出结果展示InferCNV算法 用途 利用inferCNV工具对空间转录组数据进行拷贝数变异（CNV）推断，帮助揭示组织中不同区域的基因组变异特征。同时该工具也支持对scRNA-Seq数据进行CNV推断。 运行方式 使用细胞注释后的h5ad，准备rds文件： SDAS dataProcess h5ad2rds -i st.h5ad -o outdir 运行inferCNV SDAS infercnv -i st.rds --h5ad st.h5ad --bin_size 50 --slice_key batch \\ -o outdir --label_key anno_cell2location --species human \\ --ref_group_names B,T --min_counts_per_cell 200 输入参数说明 参数 是否必须 默认值 描述 --run_mode 否 stRNA 选择空间转录组（stRNA）或单细胞（scRNA）模式 -i / --input 是 rds文件，要求有原始表达矩阵 -o / --output 是 所有文件的输出目录 --h5ad 是 h5ad格式的sample.h5ad，用于空间热图（单细胞模式无需设置） --bin_size 是 Bin大小，控制空间热图点大小（如20,50,100），单细胞模式无需设置 --label_key 是 rds对象metadata中的注释信息字段 --ref_group_names 否 参考分组名，指定normal cell/sample分组，默认用全部cell（不推荐） --gene_order_file 否 用户自定义基因染色体位置信息文件，不提供时，使用--species指定的软件自带文件。 --cluster_heatmap 否 False 是否对cell聚类展示CNV heatmap（True/False） --species 否 human 指定预先构建好的物种的*_pos.txt，‘human’ 或者‘mouse’，默认‘human’，当指定--gene_order_file参数时，该参数不起作用 --slice_key 否 sampleID 多片h5ad.obs中表示片编号的列名 --gene_symbol_key 否 real_gene_name rds中基因名(symbol)的列名（_index为矩阵列名） --assay 否 rds中用于计算cnv的assay名称 --cutoff 否 0.02 基因过滤参数，参考细胞/bins中每基因最小平均counts数 --min_counts_per_cell 否 100 每个cell的最小counts数 输出结果展示 结果文件 描述 _run.final.infercnv_obj.rds 包含所有基因和spot的cnv矩阵的rds对象 _CNV_score.csv 每个spot的cnv score _CNV_ref.png/pdf 参考细胞的CNV表达热图（ref_group_names为None时不输出） _CNV_obs.png/pdf 观测细胞的CNV表达热图 _CNV_score.png/pdf CNV score的空间热图（多片时每片一张，单细胞模式不输出） 参考细胞的CNV表达热图：_CNV_ref.png/pdf 横轴为spot，纵轴为基因，颜色为CNV强度 观测细胞的CNV表达热图：_CNV_obs.png/pdf 横轴为spot，纵轴为基因，颜色为CNV强度 --cluster_heatmap False ： 不对spot进行聚类 --cluster_heatmap True：对spot进行聚类 CNV score空间热图：_CNV_score.png/pdf 颜色为CNV强度 CNV score文本文件：_CNV_score.csv，值越大代表CNV强度越高 spot_id CNV_score 429496737600_D03663C6 0.0018 429496737700_D03663C6 0.0015 429496737800_D03663C6 0.0031 ... ... © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cnv/04_performence.html":{"url":"readme/04_manual/cnv/04_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 运行时间和内存与细胞数、基因数正相关，数据量越大，耗时和内存越高。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/":{"url":"readme/04_manual/coexpress/","title":"空间基因共表达","keywords":"","body":"空间基因共表达空间基因共表达 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/01_intro.html":{"url":"readme/04_manual/coexpress/01_intro.html","title":"简介","keywords":"","body":"简介算法测评经验参考文献简介 空间基因共表达分析旨在识别在空间上具有相似表达模式的基因模块，帮助理解基因间的相互作用、功能分组以及核心基因的挖掘。通过对空间转录组数据的深入挖掘，可以揭示组织结构与功能的空间异质性。它同时为基因集富集分析、蛋白互作网络分析、公共数据库验证在内的多种下游分析提供基因集基础。 算法测评经验 如果希望快速获得结果，建议首先尝试使用 hdWGCNA 和 NeST 两种方法。hdWGCNA 在共表达基因集的基因功能分析方面表现出更高的一致性，而 NeST 则展现出更精准的空间模式识别能力。此外，若您的数据矩阵过于稀疏，可以考虑尝试使用 Hotspot 来处理。详细算法测评信息，请参考此链接。 算法 hdWGCNA NeST Hotspot 结果量级 ⭐⭐ ⭐⭐ ⭐⭐⭐ 空间模式识别 ⭐⭐ ⭐⭐⭐ ⭐ 基因功能一致性 ⭐⭐⭐ ⭐ ⭐⭐ 运行时间 ⭐⭐⭐ ⭐⭐⭐ ⭐ 参考文献 DeTomaso, D., & Yosef, N. (2021). Hotspot identifies informative gene modules across modalities of single-cell genomics. Cell systems, 12(5), 446-456. Morabito, S., Reese, F., Rahimzadeh, N., Miyoshi, E., & Swarup, V. (2023). hdWGCNA identifies co-expression networks in high-dimensional transcriptomics data. Cell reports methods, 3(6). Walker, B. L., & Nie, Q. (2023). NeST: nested hierarchical structure identification in spatial transcriptomic data. Nature communications, 14(1), 6554. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/02_input.html":{"url":"readme/04_manual/coexpress/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明莫兰指数文件格式说明(非必须)输入文件示例 h5ad数据格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、空间坐标等信息。具体请参考SDAS输入数据格式描述。 莫兰指数文件格式说明(非必须) ./moran.csv：已经计算好的基因莫兰指数文件，(包含了squidpy分析的Moran's I 指数分析的结果，前2列为必需列：与h5ad一致的基因名称和moranI)，以逗号分隔，示例内容如下： moranI pval_norm var_norm pval_norm_fdr_bh real_gene_name ENSG00000164433 0.8273024881077159 0.0 0.0 0.0001022749701474042 FABP5 ENSG00000106078 0.8203151436536835 0.0 0.0 0.0001022749701474042 STX3 ENSG00000170260 0.7993499975159156 0.0 0.0 0.0001022749701474042 HSPB1 ENSG00000163220 0.797949719212986 0.0 0.0 0.0001022749701474042 S100A9 ENSG00000187021 0.7868677451739036 0.0 0.0 0.0001022749701474042 NTS © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/03_hdwgcna.html":{"url":"readme/04_manual/coexpress/03_hdwgcna.html","title":"hdWGCNA算法","keywords":"","body":"hdWGCNA算法用途运行方式输入参数说明输出结果展示结果解读说明调参建议hdWGCNA算法 用途 使用hdWGCNA 算法进行空间基因共表达基因集识别 运行方式 SDAS coexpress hdwgcna -i st.h5ad -o outdir --bin_size 100 \\ --input_layer raw_counts \\ --selected_genes top5000 \\ --moran_path ./moran.csv \\ --n_cpus 8 \\ --seed 42 \\ --knn_neighbors 50 \\ --max_shared_cells 15 \\ --soft_power 8 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --bin_size 是 50 分辨率Bin大小（20, 50, 100, 200, cellbin），与输入h5ad一致 --layer 否 指定h5ad中原始表达矩阵的layer层 （例如layers[‘raw_counts’] --selected_genes 否 top5000 基因列表（topn高变基因, full全部基因） --moran_path 否 已计算好的基因莫兰指数列表路径 --n_cpus 否 8 并行计算进程数 --seed 否 42 随机种子 --knn_neighbors 否 50 合并细胞时KNN算法覆盖的邻域spot/细胞个数（k neighbor） --max_shared_cells 否 15 合并细胞时KNN算法覆盖的最多交集spot/细胞个数 --soft_power 否 网络构建时使用，默认自动选择无标度拓扑模型拟合度达到 0.8 的最低 soft_power 输出结果展示 结果文件 描述 _hdwgcna.module.csv 空间高变基因（gene symbol+gene id）对应的共表达基因集（module）的共表达基因集的结果csv _hdwgcna.module_score.csv 共表达基因集的基因集打分结果csv _hdwgcna.coexpress.rds 含有共表达基因集结果的rds文件 _hdwgcna.module_score.png/pdf 共表达基因集的基因集打分空间热图 _hdwgcna.all_coex_dendrogram.png/pdf 共表达基因集的相似性树状图 _hdwgcna.softpowers.png/pdf 构建网络的soft_power阈值图 _hdwgcna.moran.csv 如果使用topn计算，输出全部基因的莫兰指数以及P值 共表达基因集的结果csv：_hdwgcna.module.csv，以逗号分隔。hdWGCNA输出结果展示识别的空间高变基因对应的共表达基因集（module），kME表示某个基因的表达模式与所在模块的​​模块特征基因（Module Eigengene, ME）​​之间的相关性强度，kME值越接近1或-1，表明该基因越可能是枢纽基因（hub gene） real_gene_name geneid Module color kME_Module1 kME_Module2 kME_grey kME_Module3 kME_Module4 kME_Module5 kME_Module6 kME_Module7 kME_Module8 kME_Module9 A2M ENSG00000175899 Module1 green 0.47946868988301 -0.107096403482606 -0.178114022165641 0.0676792398874597 0.095966109797419 -0.0907050325056857 -0.0529390531160642 -0.150612945887371 0.0878907827651177 0.0249952108382643 A2M-AS1 ENSG00000237094 Module1 green 0.54370397007705 -0.150011910577089 -0.254597937099371 0.0926882061841318 0.140032173496191 -0.115227951266487 -0.101675353602963 -0.222107282189061 0.0803636102659976 0.0426306888623326 A2ML1 ENSG00000166535 Module2 yellow 0.0404144692736028 0.479908573141937 0.194701680726881 -0.327610748128114 0.0430624759042059 0.429681007497005 -0.342984504779987 0.145625804577339 -0.386999928188458 0.08281144751312791 A2MP1 ENSG00000256069 grey grey -0.046660656715667 0.20294339804614 0.284819067476003 -0.0506850476403686 -0.205976941174478 0.244779685854094 0.000250607520833238 0.170101997387916 -0.0177549796818324 0.0639042087827032 共表达基因集的基因集打分结果csv：_hdwgcna.module_score.csv，以逗号分隔。hdWGCNA输出结果展示识别的每个共表达基因集（module）的表达量打分的高低 Module6 Module3 Module8 Module2 grey Module7 Module5 Module9 Module1 Module4 2200_16100 -3.23688863476392 -4.34756288337066 -2.3278151796256 -8.21694142422341 -14.8112682710791 -9.12253218247156 -10.174563894144 -3.09447240000024 0.481660736850741 3.91787079378259 2200_17200 5.77873502485046 0.783016254503074 1.06582091429724 -6.03050203635639 -3.71256039305597 -0.825856084852031 -3.67468239887104 -2.09159016878048 -2.639251117267012 5.41583186417414 2300_16700 7.90521666109811 2.93759207152763 -0.391450035802177 -3.02639637030598 1.63013439679168 1.66371621513915 -1.51360146647437 -0.8975499248414 -4.66703690157902 1.40723191567521 共表达基因集的基因集打分空间热图_hdwgcna.module_score.png/pdf：可视化所有共表达基因集（Module）的空间分布模式。图中颜色强度表示共表达基因集表达量的高低 构建网络的soft_power阈值图_hdwgcna.softpowers.png/pdf：分析不同软阈值参数的网络构建效果，默认自动选择无标度拓扑模型拟合度达到 0.8 的最低 soft_power 共表达基因集的相似性树状图_hdwgcna.all_coex_dendrogram.png/pdf：展示不同共表达基因集（Module）之间的相似性聚类树状图 结果解读说明 共表达基因集从Module1开始，grey为不符合共表达基因集聚类要求的基因。 调参建议 若样本bin20/50基因数低于200，或其他特殊样本，识别的空间共表达基因集较少，可根据soft_power测试图调低阈值。 可自定义knn_neighbors、max_shared_cells参数以获得更多可解读结果。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/04_hotspot.html":{"url":"readme/04_manual/coexpress/04_hotspot.html","title":"Hotspot算法","keywords":"","body":"Hotspot算法用途运行方式输入参数说明输出结果展示结果解读说明调参建议Hotspot算法 用途 使用Hotspot算法进行空间基因共表达基因集识别 运行方式 SDAS coexpress hotspot -i st.h5ad -o outdir --bin_size 100 \\ --layer raw_counts \\ --selected_genes top5000 \\ --moran_path ./moran.csv \\ --n_cpus 8 \\ --seed 42 \\ --fdr_cutoff 0.05 \\ --model bernoulli 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --bin_size 是 50 分辨率Bin大小（20, 50, 100, 200, cellbin），与输入h5ad一致，画图与计算均需要 --layer 否 指定h5ad中原始表达矩阵的layer层 （例如layers[‘raw_counts’] --selected_genes 否 top5000 基因列表（topn高变基因, full全部基因） --moran_path 否 已计算好的基因莫兰指数列表路径 --n_cpus 否 8 并行计算进程数 --seed 否 42 随机种子 --fdr_cutoff 否 0.05 统计检验空间高变基因与共表达基因集的FDR矫正阈值 --model 否 normal 统计检验假设（normal, bernoulli, danb, none） 输出结果展示 结果文件 描述 _hotspot.module.csv 空间高变基因（gene symbol+gene id）对应的共表达基因集（module）的共表达基因集的结果csv _hotspot.h5ad 含有共表达基因集结果的h5ad文件（adata.obsm[‘module_score_hotspot’]) _hotspot_module_score_hotspot.png/pdf 共表达基因集的基因集打分空间热图 _hotspot.all_coex_heatmap.png/pdf 共表达基因集的相似性热图 _hotspot.moran.csv 如果使用topn计算，输出全部基因的莫兰指数以及P值 共表达基因集的结果csv：_hotspot.module.csv，以逗号分隔。Hotspot识别的空间高变基因对应的共表达基因集（module） geneid real_gene_name FDR Module ENSG00000163209 SPRR3 0.0 Module-1 ENSG00000151632 AKR1C2 0.0 Module-1 ENSG00000170345 FOS 0.0 Module-1 ENSG00000164433 FABP5 0.0 Module-1 ENSG00000120129 DUSP1 0.0 Module-1 共表达基因集的基因集打分空间热图_hotspot_module_score_hotspot.png/pdf：可视化所有共表达基因集（Module）的空间分布模式。图中颜色强度表示共表达基因集表达量的高低 共表达基因集的相似性热图_hotspot.all_coex_heatmap.png/pdf：展示不同共表达基因集（Module）之间的相似性聚类关系。图中颜色表示不同共表达基因集的相似度，红色为高度相似 结果解读说明 共表达基因集从Module1开始，Module-1/没有Module为不符合共表达基因集聚类要求的基因。 调参建议 若样本bin20/50基因数低于200，或其他特殊样本，识别的空间高变基因/共表达基因集较少，建议将model参数从normal改为bernoulli，并将fdr_cutoff设置为0.05。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/05_nest.html":{"url":"readme/04_manual/coexpress/05_nest.html","title":"NeST算法","keywords":"","body":"NeST算法用途运行方式输入参数说明输出结果展示结果解读说明调参建议NeST算法 用途 使用NeST 算法进行空间基因共表达基因集识别 运行方式 SDAS coexpress nest -i st.h5ad -o outdir --bin_size 100 \\ --layer raw_counts \\ --selected_genes top5000 \\ --moran_path ./moran.csv \\ --n_cpus 8 \\ --seed 42 \\ --hotspot_min_size 30 \\ --hotspot_min_samples 4 \\ --min_cells 100 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求有原始表达矩阵 -o / --output 是 输出文件夹 --bin_size 是 50 分辨率Bin大小（20, 50, 100, 200, cellbin），与输入h5ad一致，画图与计算均需要 --layer 否 指定h5ad中原始表达矩阵的layer层 （例如layers[‘raw_counts’] --selected_genes 否 top5000 基因列表（topn高变基因, full全部基因） --moran_path 否 已计算好的基因莫兰指数列表路径 --n_cpus 否 8 并行计算进程数 --seed 否 42 随机种子 --hotspot_min_size 否 30 空间高变单基因覆盖的最少spot/细胞数 --hotspot_min_samples 否 4 识别空间高变单基因时DBSCAN算法覆盖的最少邻域spot/细胞个数（k neighbor） --min_cells 否 100/30 共表达基因集覆盖的最少spot/细胞个数，默认：cellbin/bin20/bin50时为100；bin100/bin200时为30 输出结果展示 结果文件 描述 _nest.module.csv 空间高变基因（gene symbol+gene id）对应的共表达基因集（module）的共表达基因集的结果csv _nest.h5ad 含有共表达基因集结果的h5ad文件（adata.obsm[‘module_score_nest’]) _nest_module_score_nest.png/pdf 共表达基因集的基因集打分空间热图 _nest.all_coex_hotspots/_nest.all_coex_structure.png/pdf 共表达基因集的空间位置与层级结构 _nest.separate_coex_hotspots.png/pdf 共表达基因集的空间位置与基因个数 _nest.moran.csv 如果使用topn计算，输出全部基因的莫兰指数以及P值 共表达基因集的结果csv：_nest.module.csv，以逗号分隔。NeST识别的空间高变基因对应的共表达基因集（module） Module geneid real_gene_name Module0 ENSG00000116016 EPAS1 Module0 ENSG00000106554 CHCHD3 Module0 ENSG00000104164 MDGA2 共表达基因集的基因集打分空间热图_nest_module_score_nest.png：可视化所有共表达基因集（Module）的空间分布模式。图中颜色强度表示共表达基因集表达量的高低 共表达基因集的空间位置与层级结构_nest.all_coex_hotspots.png/pdf;_nest.all_coex_structure.png/pdf：展示不同共表达基因集（Module）之间的层级关系。图中颜色表示不同共表达基因集所在的空间区域 共表达基因集的空间位置与基因个数_nest.separate_coex_hotspots.png/pdf：可视化所有共表达基因集（Module）所在的空间区域以及包含的基因数量 结果解读说明 共表达基因集从Module0开始，没有Module为不符合共表达基因集聚类要求的基因。 调参建议 若样本bin20/50基因数低于200，或其他特殊样本，识别的空间高变基因较少，建议降低hotspot_min_size到10。 识别的空间共表达基因集较少，建议降低min_cells到10。 若识别pattern过于精细，出现\"NumPy Unable to allocate X GiB array\"报错，建议升高hotspot_min_size和hotspot_min_samples。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/coexpress/06_performence.html":{"url":"readme/04_manual/coexpress/06_performence.html","title":"性能测试","keywords":"","body":"性能测试Stereo-seq测试数据运行时间与内存占用性能测试 Stereo-seq测试数据 我们共测试了11个样本，包括小鼠大脑和多种人类肿瘤样本。每个样本测试了cellbin、bin20、bin50和bin100（若可用）。bin20数据的基因数约100至900。 Cellbin Bin20 Bin50 Bin100 基因数量 300~1千 100-900 600-4千 1.9千以上 细胞数量 30万-40万 50万-70万 8万-12万 2万-3万 运行时间与内存占用 NeSt/hotspot/hdWGCNA算法使用n_cpus控制并行线程数，该性能测试使用n_cpus=8。 运行时间和内存需求与细胞及基因数量呈显著正相关，即数据规模越大，计算耗时和内存占用越高。 运行时间：hotspot > nest/hdWGCNA 内存：nestt/hdWGCNA > hotspot © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/deg/":{"url":"readme/04_manual/deg/","title":"差异基因分析","keywords":"","body":"差异基因分析差异基因分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/deg/01_intro.html":{"url":"readme/04_manual/deg/01_intro.html","title":"简介","keywords":"","body":"简介模块算法整体介绍参考文献简介 时空转录组测序能够在指定的分辨率下揭示细胞间的异质性。差异表达分析用于识别在不同细胞群体或条件下表达显著变化的基因（Differential Expression Gene, DEG）。它同时为基因集富集分析、蛋白互作网络分析、公共数据库验证在内的多种下游分析提供基因集基础。 根据数据特性和分析目标，常用的差异分析方法主要分为两大类：单细胞水平方法和pseudobulk方法。 单细胞水平方法（t-test、Wilcoxon、MAST）：适用于没有生物学重复，关注细胞亚群间差异，或样本量有限的场景。 pseudobulk方法（DESeq2、edgeR）：当有多个生物学重复时，可将同一组内细胞的表达量汇总（如求和或取均值），形成\"伪体积\"（pseudobulk）表达矩阵，再用bulk RNA-seq的差异分析方法（DESeq2、edgeR）进行分析，能更准确反映生物学变异，降低假阳性率。 模块算法整体介绍 分析模块 单片或多片 差异分析场景 可用的分析方法 DEG 单片 1-vs-1 t-test, wilcoxcon, MAST DEG 单片 1-vs-n t-test, wilcoxcon, MAST DEG 没有生物学重复样本的多片 1-vs-1 t-test, wilcoxcon, MAST DEG 没有生物学重复样本的多片 1-vs-n t-test, wilcoxcon, MAST DEG 有生物学重复样本的多片 1-vs-1 DESeq2, edgeR DEG 有生物学重复样本的多片 1-vs-n DESeq2 参考文献 Finak, G., McDavid, A., Yajima, M., Deng, J., Gersuk, V., Shalek, A. K., ... & Gottardo, R. (2015). MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data. Genome biology, 16(1), 278. Hao, Y., Stuart, T., Kowalski, M. H., Choudhary, S., Hoffman, P., Hartman, A., ... & Satija, R. (2024). Dictionary learning for integrative, multimodal and scalable single-cell analysis. Nature biotechnology, 42(2), 293-304. Robinson, M. D., McCarthy, D. J., & Smyth, G. K. (2010). edgeR: a Bioconductor package for differential expression analysis of digital gene expression data. bioinformatics, 26(1), 139-140. Wolf, F. A., Angerer, P., & Theis, F. J. (2018). SCANPY: large-scale single-cell gene expression data analysis. Genome biology, 19(1), 15. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/deg/02_input.html":{"url":"readme/04_manual/deg/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明输入文件示例 h5ad数据格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、基因名、差异分析分组等信息。具体请参考SDAS输入数据格式描述 使用DESeq2或edgeR进行有生物学重复样本的差异分析时，必须使用原始表达矩阵。 h5ad文件的key和value中避免出现空格、/、+、,、~等特殊字符，否则可能导致流程报错 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/deg/03_deg.html":{"url":"readme/04_manual/deg/03_deg.html","title":"单细胞/pseudobulk差异分析","keywords":"","body":"单细胞/pseudobulk差异分析用途与运行方式1. 单细胞水平差异分析（无生物学重复）2. pseudobulk差异分析（有生物学重复）输入参数说明输出结果展示结果解读说明调参建议单细胞/pseudobulk差异分析 用途与运行方式 1. 单细胞水平差异分析（无生物学重复） 支持t-test、wilcoxon、MAST 场景一：指定类别1与类别2差异分析 SDAS DEG -i st.h5ad -o outdir --group_key leiden --de_method wilcoxon \\ --ident1 1 --ident2 2 \\ --fdr 0.05 --log2fc 1 场景二：每个类别与其余类别分别做差异分析 SDAS DEG -i st.h5ad -o outdir --group_key leiden --de_method wilcoxon \\ --fdr 0.05 --log2fc 1 场景三：对obs的某列做子集后再差异分析 SDAS DEG -i st.h5ad -o outdir --group_key leiden --de_method wilcoxon \\ --ident1 1 --ident2 2 \\ --fdr 0.05 --log2fc 1 \\ --subset_key cell_type --subset_values B 2. pseudobulk差异分析（有生物学重复） 推荐DESeq2、edgeR（pseudobulk分析），需指定--sample_key，且每组样本数需满足方法要求（DESeq2≥3，edgeR≥2） 场景一：两组样本直接差异分析 SDAS DEG -i st.h5ad -o outdir --group_key sampleID --de_method DESeq2 \\ --ident1 Tumor --ident2 Normal \\ --fdr 0.05 --log2fc 1 \\ --sample_key sampleID 场景二：子集后做pseudobulk差异分析 SDAS DEG -i st.h5ad -o outdir --group_key sampleID --de_method DESeq2 \\ --ident1 Tumor --ident2 Normal \\ --fdr 0.05 --log2fc 1 \\ --sample_key sampleID \\ --subset_key cell_type --subset_values B 输入参数说明 DEG参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求原始矩阵 -o / --output 是 分析结果存放路径 --de_method 是 指定差异分析方法：{t-test,wilcoxon,MAST,DESeq2,edgeR} --group_key 是 需要进行差异分析的对象所在的obs名称 --ident1 否 用于分析差异表达基因的对象，类似处理组，不写则按1-vs-rest方式逐个输出 --ident2 否 用于做对照的对象，类似对照组，不写则将剩余元素当作对照，类似1-vs-rest --sample_key 否 存放样本信息的obs名称，使用DESeq2或edgeR时进行pseudobulk差异分析时必须指定且必须存在生物学重复样本，使用DESeq2时必须有>=3个生物学重复，使用edgeR时必须有>=2个生物学重复 --subset_key 否 需要提取的值所属的分组列名称 --subset_values 否 需要提取的值，存在多个时用','分隔 --layer 否 指定表达矩阵，不指定时用adata.raw.X或adata.X --gene_symbol_key 否 real_gene_name 指定genename所在列，默认用obs.real_gene_name --fdr 否 0.05 Padj（FDR）的阈值，用于筛选显著差异基因 --log2fc 否 1 log2FC的绝对值阈值，用于筛选显著差异基因 --genelist 否 5 在图中标出感兴趣的基因，多个基因可用','分隔，默认用显著上调和下调各5个基因 --add_label 否 对h5ad的obs增加额外的标签 --min_gene 否 0 一个bin/cell允许的最少基因数 --max_gene 否 一个bin/cell允许的最多基因数 --min_cell 否 0 某个基因最少存在于多少个bin/cell中 输出结果展示 结果文件 描述 de_{method}.{group_key}.{ident1}-vs-{ident2}.raw.csv 软件原始的输出结果 de_{method}.{group_key}.{ident1}-vs-{ident2}.all.csv 从原始结果中提取出geneID、log2FC、Pvalue、FDR等信息的结果 de_{method}.{group_key}.{ident1}-vs-{ident2}.sig_filtered.csv 根据log2FC和Pvalue过滤后的显著差异结果 de_{method}.{group_key}.{ident1}-vs-{ident2}.png/pdf png或pdf格式的火山图 raw文件格式示例：de_{method}.{group_key}.{ident1}-vs-{ident2}.raw.csv 这个文件是差异分析软件生成的分析结果，里面可能包含除了基因名、差异倍数、Pvalue、adjusted Pvalue（FDR）等信息外的其他信息。 names scores logfoldchanges pvals pvals_adj MTATP6P1 16.74336 1.3794351 1.3877341418899603e-42 2.2785333033340524e-39 AGR2 13.671169 1.7758344 1.419568544127444e-32 1.1147316293689464e-29 CLDN4 13.663365 1.9820584 1.9626883546881656e-34 1.6880054463820458e-31 ... ... ... ... ... all/sig_filtered文件格式示例：de_{method}.{group_key}.{ident1}-vs-{ident2}.all.csv 文件是从差异分析软件生成的分析结果中提取了基因名、差异倍数、Pvalue、adjusted Pvalue（FDR）重新统一命名后的结果文件，de_{method}.{group_key}.{ident1}-vs-{ident2}.sig_filtered.csv文件是根据log2FC和FDR阈值进行筛选后得到的显著差异基因列表。 gene log2FC pvalue FDR MTATP6P1 1.3794351 1.3877341418899603e-42 2.2785333033340524e-39 AGR2 1.7758344 1.419568544127444e-32 1.1147316293689464e-29 CLDN4 1.9820584 1.9626883546881656e-34 1.6880054463820458e-31 ... ... ... ... 火山图结果示例: de_{method}.{group_key}.{ident1}-vs-{ident2}.png/pdf 图中红色的点表示同时达到log2FC和FDR筛选阈值的显著差异基因，蓝色的点表示达到FDR筛选条件但没达到log2FC条件的基因，绿色的点表示达到log2FC筛选条件但没达到FDR条件的基因，同时，默认会在图中标出差异倍数最高和最低的5个基因，如果需要在图中标注指定的基因，可以通过genelist参数进行指定(例如， --genelist geneA,geneB,geneC)。 结果解读说明 基因名唯一化 差异分析前会自动对基因名进行make_unique，所有输出和作图均使用唯一化后的基因名。 细胞和基因过滤 支持通过--min_gene、--max_gene、--min_cell等参数对细胞和基因进行过滤。若h5ad已过滤，可不再设置。 调参建议 超过200k的bin/cell数据量时MAST无法成功运行，这种情况下可以通过设置更严格的过滤参数（min_gene和min_cell）减少bin/cell的数量再进行分析。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/deg/04_performence.html":{"url":"readme/04_manual/deg/04_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 使用不同bin数量的数据对t-test、wilcoxon和MAST这3种差异方法进行了1对1和1对多的分析场景测试，统计运行时间和需要的最大内存。 运行时间：MAST > t-test/wilcoxon 内存：MAST > t-test/wilcoxon © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/":{"url":"readme/04_manual/geneset_enrichment/","title":"基因富集分析","keywords":"","body":"基因富集分析基因富集分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/01_intro.html":{"url":"readme/04_manual/geneset_enrichment/01_intro.html","title":"简介","keywords":"","body":"简介模块算法整体介绍参考文献简介 模块算法整体介绍 模块 子模块 功能介绍 输入文件的格式 geneSetEnrichment gsea 基于经典的基因集富集分析（Gene Set Enrichment Analysis, GSEA）方法，利用表达谱数据和表型标签（如实验组 vs 对照组）计算基因集在排序基因列表中的富集程度，识别与表型显著相关的通路或功能模块。 Stereo-seq h5ad geneSetEnrichment gsva 执行基因集变异分析（Gene Set Variation Analysis, GSVA），属于非参数的无监督分析方法。通过将基因表达矩阵转换为基因集活性矩阵，评估基因集在单个样本中的富集分数，适用于发现样本间基因集的活性差异（如肿瘤亚型分析）。 Stereo-seq h5ad geneSetEnrichment prerank 针对预排序的基因列表（如根据差异表达分析的logFC或p值排序）进行富集分析，无需原始表达数据。常用于灵活性更高的场景（如整合不同排序指标），直接评估基因集在排序列表中的富集程度。 带有gene信息和log2FC值的csv格式文件 geneSetEnrichment enrichr 对输入的基因列表进行富集分析，支持多种功能数据库（如GO、KEGG、WikiPathways）。快速获取基因列表在已知通路或功能中的富集结果，适合小规模基因集的快速注释。 带有gene信息和log2FC值的csv格式文件 参考文献 Fang, Z., Liu, X., & Peltz, G. (2023). GSEApy: a comprehensive package for performing gene set enrichment analysis in Python. Bioinformatics, 39(1), btac757. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/02_input.html":{"url":"readme/04_manual/geneset_enrichment/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明数据库说明(非必须)输入文件示例 h5ad数据格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、基因名、差异分析分组等信息。具体请参考SDAS输入数据格式描述gsea和gsva 直接基于此h5ad文件。 prerank要求输入st.h5ad文件的某obs列必须有geneID和log2FC，分析结果与gsea类似，建议输入所有基因的结果列表； enrichr要求输入st.h5ad文件的某obs列必须有deg_gene_name，建议输入显著差异基因列表； 数据库说明(非必须) 4种富集分析功能都支持gmt格式的数据库文件，且数据库中的gene name都为大写，SDAS中自带标准构建好的人和小鼠数据库； 输入自定义的gmt数据库时，gene信息必须为大写，因为流程会将gene信息都改为大写再与数据库进行匹配； 软件默认下载了human和mouse的Msigdb数据库，如果想用其他数据库可用其它gmt，可以在SDAS软件路径sdas_deg_enrichment/lib/GSEA_DB下根据需求使用--gmt进行指定； © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/03_gsea.html":{"url":"readme/04_manual/geneset_enrichment/03_gsea.html","title":"GSEA算法","keywords":"","body":"GSEA算法用途与运行方式输入参数说明输出结果展示GSEA算法 用途与运行方式 场景一：指定类别1与类别2进行gsea分析，其中--ident1做为处理，--ident2做为对照 SDAS geneSetEnrichment gsea -i st.h5ad -o outdir \\ --group_key leiden --ident1 1 --ident2 2 --species human 场景二：对obs的某列做子集后再进行gsea分析 SDAS geneSetEnrichment gsea -i st.h5ad -o outdir \\ --group_key leiden --ident1 1 --ident2 2 --species human \\ --subset_key cell_type --subset_values B 场景三：只用感兴趣的数据库进行分析 SDAS geneSetEnrichment gsea -i st.h5ad -o outdir \\ --group_key leiden --ident1 1 --ident2 2 \\ --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt,sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt 场景四：只对感兴趣的通路进行作图，将感兴趣的通路全名写入一个txt文档里面，每个通路一行，然后将这个txt文档通过--pathways参数传入分析流程。需要注意的是使用的数据库中必须包含这些指定的通路名称 SDAS geneSetEnrichment gsea -i st.h5ad -o outdir \\ --group_key leiden --ident1 1 --ident2 2 \\ --pathways ./pathway.txt \\ --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt,sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt 输入参数说明 gsea参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求原始矩阵 --group_key 是 需要用于进行gsva分析的对象，用','分隔多个对象 --ident1 是 用于进行GSEA分析的对象名，类似处理组 --ident2 是 用于做对照的对象名 -o / --output 是 结果存放路径 --layer 否 指定表达矩阵，默认用adata.raw.X或adata.X --gene_symbol_key 否 real_gene_name 指定gene name所在列，默认real_gene_name，如果没有则使用矩阵中的原始基因信息 --species 否 human 指定数据库，'human' 或 'mouse'，默认 'human'，当指定--gmt参数时，该参数不起作用 --subset_key 否 需要提取的值所属的obs名称 --subset_values 否 需要提取的信息，存在多个时用','分隔 --sample_size 否 0 对输入文件的bin数量进行随机取样以减小内存消耗，默认值为0，不做采样 --gmt 否 gmt格式的数据库文件，其中gene name信息必须为大写，多个文件时用','隔开 --graph 否 5 筛选top数量的通路进行画图，默认'5'，指定--pathways参数时，该参数不起作用 --pathways 否 通过txt文件指定一个或多个感兴趣的通路进行画图，这些通路必须在gmt数据库中 --permutation_type 否 gene_set 小于1000个样本时用‘gene_set’，大于1000个样本时用‘phenotype’。默认‘gene_set’。 -v / --verbose 否 启用详细模式，打印任务进度。默认：False --permutation_num 否 1000 随机置换次数（用于计算ES空值分布）。默认：1000 --min_size 否 15 基因集中包含的输入基因最小数量。默认：15 --max_size 否 500 基因集中包含的输入基因最大数量。默认：500 --weight 否 1 排序指标权重（用于调整基因权重），可选值：{0, 1, 1.5, 2}。默认：1 --method 否 signal_to_noise 基因排序相关性计算方法，可选值： {'signal_to_noise', 'abs_signal_to_noise', 't_test', 'ratio_of_classes', 'diff_of_classes', 'log2_ratio_of_classes'}。默认：'signal_to_noise' --ascending 否 设置排序指标为升序（指定此参数则ascending=True）。默认：False（降序） --seed 否 123 随机数种子值。默认：123 --threads 否 1 并行计算使用的线程数。默认：1 输出结果展示 gsea结果文件 描述 GSEA.{database}.csv csv格式的结果文件 GSEA.{database}.top5.pdf/png pdf和png格式的图像文件 文件格式示例：GSEA.{database}.csv 这个文件是gsea分析结果文件，包含了Name,Term,ES,NES,NOM p-val,FDR q-val,FWER p-val,Tag %,Gene %,Lead_genes等信息。其中Term是通路名称；ES是富集得分(Enrichment Score)，反映基因集成员在排序基因列表（如差异表达基因排序）中的富集程度，正ES：基因集在排序列表顶部富集（与表型正相关），负ES：基因集在排序列表底部富集（与表型负相关）；NES是标准化富集得分 (Normalized Enrichment Score)；NOM p-val是名义p值；FDR q-val是校正后的p值；FWER p-val是族系错误率校正后的p值；Tag %是基因集中位于排序列表核心富集区域的基因百分比；Gene %是分析中实际使用到的基因占基因集总基因数的百分比；Lead_genes是对富集得分（ES）贡献最大的核心基因。 Name Term ES NES NOM p-val FDR q-val FWER p-val Tag % Gene % Lead_genes gsea HALLMARK_MYC_TARGETS_V1 0.7472938191195556 2.39333105644001 0.0 0.0 0.0 160/195 18.89% RPL14;HNRNPA2B1;... gsea HALLMARK_OXIDATIVE_PHOSPHORYLATION 0.7431758291176868 2.376055485647371 0.0 0.0 0.0 168/200 20.44% MDH2;COX8A;... gsea HALLMARK_ALLOGRAFT_REJECTION 0.744882727767552 2.3688992213810462 0.0 0.0 0.0 118/194 14.03% ITGB2;HLA-DRA;... gsea ... ... ... ... ... ... ... ... ... top Terms富集曲线图：GSEA.{database}.top5.pdf/png （见下图示例），图中Enrichment Score为正说明改Term与--ident1正相关，为负说明为负相关。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/04_gsva.html":{"url":"readme/04_manual/geneset_enrichment/04_gsva.html","title":"GSVA算法","keywords":"","body":"GSVA算法用途与运行方式输入参数说明输出结果展示GSVA算法 用途与运行方式 场景一：指定具体对象进行gsva分析，例如指定leiden聚类中的1、2、3这几个cluster进行gsva分析 SDAS geneSetEnrichment gsva-i st.h5ad -o outdir \\ --group_key leiden --idents 1,2,3 --species human 场景二：对obs的某列做子集后再进行gsva分析，例如只对某种细胞类型的不同样本进行gsva分析 SDAS geneSetEnrichment gsva-i st.h5ad -o outdir \\ --group_key leiden --idents 1,2,3 --species human \\ --subset_key cell_type --subset_values B 场景三：只用感兴趣的数据库进行分析 SDAS geneSetEnrichment gsva-i st.h5ad -o outdir \\ --group_key leiden --idents 1,2,3 \\ --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt,sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt 场景四：对obs中某列的所有元素一起进行gsva分析，要将某列中的所有元素放到一起进行gsva分析，此时--idents参数应该写为特定字符all SDAS geneSetEnrichment gsva-i st.h5ad -o outdir \\ --group_key leiden --idents all --species human \\ 输入参数说明 gsva参数 是否必须 默认值 描述 -i / --input 是 Stereo-seq h5ad，要求原始矩阵 --group_key 是 需要进行gsva分析的对象所在的obs名称 --idents 是 需要用于进行gsva分析的对象，用','分隔多个对象 -o / --output 是 结果存放路径 --subset_key 否 需要提取的信息所属的obs名称 --subset_values 否 需要提取的信息，存在多个时用','分隔 --layer 否 指定表达矩阵，不指定时使用adata.raw.X或adata.X --gene_symbol_key 否 real_gene_name 指定gene name所在列，默认real_gene_name，如果没有则使用矩阵中的原始基因信息 --species 否 human 指定数据库，'human' 或 'mouse'，默认 'human'，当指定--gmt参数时，该参数不起作用 --sample_size 否 0 对输入文件的bin数量进行随机取样以减小内存消耗，默认值为0，不做采样 --gmt 否 gmt格式的数据库文件，其中gene name信息必须为大写，多个文件时用','隔开 --kernel_cdf 否 Gaussian 基于原始表达矩阵时选'Poisson'，其他选'Gaussian' -v / --verbose 否 启用详细模式，打印任务进度。默认：False --mx_diff 否 设置时，富集分数（ES）将计算为随机游走的最大偏离距离。默认：False --abs_ranking 否 仅当未设置--mx_diff时生效，使用原始的Kuiper统计量计算方法。默认：False --min_size 否 15 基因集中包含的输入基因最小数量。默认：15 --max_size 否 20000 基因集中包含的输入基因最大数量。默认：20000 --weight 否 1 定义GSVA随机游走中的τ（tau）参数。默认：1 --seed 否 123 随机数种子值。默认：123 --threads 否 1 并行计算使用的进程数。默认：1 输出结果展示 gsva结果文件 描述 GSVA.{database}.csv csv格式的结果文件 GSVA.{database}.pdf/png pdf和png格式的图像文件 GSVA csv文件格式: GSVA.{database}.csv ，这个文件是gsva分析结果文件，第一列是Term表示功能名称，后面每一列表示一个样本，数值为正表示该样本在对应的功能上活性较高，数值为负表示活性较低。 Term ident1 ident2 ... HALLMARK_ADIPOGENESIS -0.32809425650271146 -0.306805475112318 .... HALLMARK_ALLOGRAFT_REJECTION -0.3052190348950549 0.22055475913564931 .... HALLMARK_ANDROGEN_RESPONSE -0.39290236695613107 -0.3080397441881526 .... ... ... ... ... gsva分析结果热图: GSVA.{database}.pdf/png，图中纵列表示功能通路名称横列表示样本名称，图例表示gsva计算的得分。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/05_enrich.html":{"url":"readme/04_manual/geneset_enrichment/05_enrich.html","title":"Enrichr算法","keywords":"","body":"Enrichr算法用途与运行方式输入参数说明输出结果展示Enrichr算法 用途与运行方式 场景一：对SDAS DEG分析得到的显著差异基因富集分析 SDAS geneSetEnrichment enrichr \\ -i de_t-test.anno_rctd.SmoothMuscle-vs-Endo.sig_filtered.csv -o outdir \\ --species human 场景二：只用感兴趣的数据库进行显著差异基因的富集分析 SDAS geneSetEnrichment enrichr \\ -i de_t-test.anno_rctd.SmoothMuscle-vs-Endo.sig_filtered.csv -o outdir \\ --gmt sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt 输入参数说明 enrichr参数 是否必须 默认值 描述 -i / --input 是 SDAS DEG 分析得到的sig_filtered.csv文件 -o / --output 是 结果存放路径 --species 否 human 指定物种的数据库，'human' 或 'mouse'，默认 'human'，当指定--gmt参数时，该参数不起作用 --gmt 否 gmt格式的数据库文件，其中gene name信息必须转为大写，多个文件时用','隔开，不提供时使用--species参数指定的物种数据库 --cut_off 否 1 富集结果作图时过滤的pvalue阈值，默认值为1，设太小可能会由于没有显著富集结果导致无法作图 --background 否 设定富集分析时使用的background，默认为所用数据库的gene数 --top_term 否 10 筛选top数量的通路进行作图，默认10 -v / --verbose 否 启用详细模式，打印任务进度。默认：False 输出结果展示 enrichr结果文件 描述 enrichment_{database}.UP.csv 上调基因的富集分析结果 enrichment_{database}.DOWN.csv 下调基因的富集分析结果 enrichment_{database}.pdf/png 上调和下调基因显著富集通路图 上/下调基因的富集分析结果: enrichment_{database}.UP/DOWN.csv ，分别对上调和下调基因进行富集分析的结果文件，文件包含Gene_set,Term,Overlap,P-value,Adjusted P-value,Odds Ratio,Combined Score,Genes这几列，分别表示基因集所属的数据库名称、具体的功能通路名称、输入基因列表中与该基因集重叠的基因数量及比例、富集分析的原始显著性p值、校正后的p值、衡量输入基因在基因集中富集的强度值、综合评分、输入基因中与该基因集重叠的具体基因名称。 Gene_set Term Overlap P-value Adjusted P-value Odds Ratio Combined Score Genes KEGG_2021_Human.gmt ABC transporters 43/45 0.00026880161509715636 0.002529897553855589 5.888896293211162 48.41577841510133 ABCA3;ABCB4;... KEGG_2021_Human.gmt AGE-RAGE signaling pathway in diabetic complications 90/100 0.00011055669162020043 0.0013606977430178514 2.928493469422023 26.678523151510976 AKT1;PLCB1;... KEGG_2021_Human.gmt AMPK signaling pathway 107/120 6.61066069653723e-05 0.0009525689822440243 2.709298083129859 26.074940028325518 AKT1;CREB3;... ... ... ... ... ... ... ... ... 富集分析结果条形图：enrichment_{database}.pdf/png不同颜色分别表示上下调基因最富集的top通路。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/06_prerank.html":{"url":"readme/04_manual/geneset_enrichment/06_prerank.html","title":"Prerank算法","keywords":"","body":"Prerank算法用途与运行方式输入参数说明输出结果展示Prerank算法 用途与运行方式 场景一：对SDAS DEG分析得到的所有差异基因进行prerank分析 SDAS geneSetEnrichment prerank \\ -i de_t-test.anno_rctd.SmoothMuscle-vs-Endo.all.csv -o ./ \\ --species human 场景二：只用感兴趣的数据库进行分析 SDAS geneSetEnrichment prerank \\ -i de_t-test.anno_rctd.SmoothMuscle-vs-Endo.all.csv -o ./ \\ --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt,sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt 场景三：只对感兴趣的通路进行作图，将感兴趣的通路全名写入一个txt文档里面，每个通路一行，然后将这个txt文档通过--pathways参数传入分析流程。需要注意的是使用的数据库中必须包含这些指定的通路名称。 SDAS geneSetEnrichment prerank \\ -i de_t-test.anno_rctd.SmoothMuscle-vs-Endo.all.csv -o ./ \\ --gmt sdas_deg_enrichment/lib/GSEADB/h.all.v2024.1.Hs.symbols.gmt,sdas_deg_enrichment/lib/GSEADB/KEGG_2021_Human.gmt \\ --pathwas ./term.txt 输入参数说明 prerank参数 是否必须 默认值 描述 -i / --input 是 SDAS DEG分析得到的all.csv文件 -o / --output 是 结果存放路径 --species 否 human 指定或构建好的物种的数据库，'human' 或 'mouse'，默认 'human'，当指定--gmt参数时，该参数不起作用 --gmt 否 gmt格式的数据库文件，其中gene name信息必须为大写，多个文件时用','隔开 --graph 否 10 筛选top数量的通路进行画图，默认'10'，设置了--pathways参数时，该参数不起作用 --pathways 否 通过txt文件指定1到多个感兴趣的通路进行画图 --min_size 否 15 基因集中包含的输入基因最小数量。默认：15 --max_size 否 20000 基因集中包含的输入基因最大数量。默认：20000 --label 否 表型标签参数需要定义两个参数。默认：('Pos','Neg') -v / --verbose 否 启用详细模式，打印任务进度。默认：False --permu_num 否 1000 随机置换次数（用于计算esnulls）。默认：1000 --weight 否 1 排序指标权重（用于调整输入基因权重），可选值：{0, 1, 1.5, 2}。默认：1 --ascending 否 设置排序指标为升序（若指定此参数则ascending=True）。默认：False（降序） --seed 否 123 随机数种子。默认：123 --threads 否 1 并行计算使用的线程数。默认：1 输出结果展示 prerank结果文件 描述 prerank_{database}.csv csv格式的结果文件 prerank_{database}:top10.pdf/png pdf和png格式的图像文件 csv文件格式:prerank_{database}.csv，文件结果跟gsea类似，包含Name,Term,ES,NES,NOM p-val,FDR q-val,FWER p-val,Tag %,Gene %,Lead_genes这几列，其中Term是通路名称；ES是富集得分(Enrichment Score)，反映基因集成员在排序基因列表（如差异表达基因排序）中的富集程度，正ES：基因集在排序列表顶部富集（与表型正相关），负ES：基因集在排序列表底部富集（与表型负相关）；NES是标准化富集得分 (Normalized Enrichment Score)；NOM p-val是名义p值；FDR q-val是校正后的p值；FWER p-val是族系错误率校正后的p值；Tag %是基因集中位于排序列表核心富集区域的基因百分比；Gene %是分析中实际使用到的基因占基因集总基因数的百分比；Lead_genes是对富集得分（ES）贡献最大的核心基因。 Name Term ES NES NOM p-val FDR q-val FWER p-val Tag % Gene % Lead_genes prerank HALLMARK_MYC_TARGETS_V1 0.7472938191195556 2.39333105644001 0.0 0.0 0.0 160/195 18.89% RPL14;HNRNPA2B1;... prerank HALLMARK_OXIDATIVE_PHOSPHORYLATION 0.7431758291176868 2.376055485647371 0.0 0.0 0.0 168/200 20.44% MDH2;COX8A;... prerank HALLMARK_ALLOGRAFT_REJECTION 0.744882727767552 2.3688992213810462 0.0 0.0 0.0 118/194 14.03% ITGB2;HLA-DRA;... prerank ... ... ... ... ... ... ... ... ... top Terms富集曲线图:prerank_{database}:top10.pdf/png（见下图示例），图中Enrichment Score（ES）的正负直接反映基因集在基于log2FC排序基因列表中的分布模式：ES为正，表示基因集成员集中在排序列表的顶部，基因集与表型正相关；ES为负，表示基因集成员集中在排序列表的底部，基因集与表型负相关。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/geneset_enrichment/07_performence.html":{"url":"readme/04_manual/geneset_enrichment/07_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 使用不同bin数量的数据进行gsea和gsva测试，统计运行时间和运行内存。测试结果显示超过200k数量的bin/cell时gsea无法正常运行，gsva需要消耗大量的计算资源。这种情况可以通过对bin/cell的数据进行随机采样（设置降采样参数--sample_size 200000）来降低数据量，再进行分析。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/ppi.html":{"url":"readme/04_manual/ppi.html","title":"蛋白互作网络分析","keywords":"","body":"蛋白互作网络分析蛋白互作网络分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/ppi/01_intro.html":{"url":"readme/04_manual/ppi/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 本模块基于STRING数据库，自动构建基因集蛋白互作网络，支持多种聚类算法（GN/MCL/Kmeans）识别功能模块，输出基因聚类归属及节点连接度（degree），并可视化网络结构。模块输出文件支持Cytoscape进一步挖掘和可视化。 参考文献 Szklarczyk, D., Kirsch, R., Koutrouli, M., Nastou, K., Mehryary, F., Hachilif, R., ... & Von Mering, C. (2023). The STRING database in 2023: protein–protein association networks and functional enrichment analyses for any sequenced genome of interest. Nucleic acids research, 51(D1), D638-D646. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/ppi/02_input.html":{"url":"readme/04_manual/ppi/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例基因列表文件STRING数据库文件(非必须)STRING数据库说明输入文件示例 基因列表文件 --input自定义基因列表文件，无表头，每行一个基因名（不可为gene id） CA8NDRG1DEFB1CYP2W1NAPRT STRING数据库文件(非必须) 可选：若为human或mouse，直接输入物种参数即可，若为自定义物种，输入--links_db与--aliases_db参数 links_db：蛋白互作关系文件（如：9606.protein.links.v12.0.txt） aliases_db：蛋白别名文件（如：9606.protein.aliases.v12.0.txt） STRING数据库说明 内置数据库来源：https://cn.string-db.org/cgi/download?sessionId=bq3ONpHVnJ16V12.0 自定义数据库构建可参考STRING官网：https://cn.string-db.org/&#x20; © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/ppi/03_function.html":{"url":"readme/04_manual/ppi/03_function.html","title":"GN/MCL/Kmeans聚类","keywords":"","body":"GN/MCL/Kmeans聚类用途运行方式输入参数说明输出结果展示GN/MCL/Kmeans聚类 用途 基于STRING数据库，自动构建基因集蛋白互作网络，同时输出3种聚类结果 运行方式 使用如下方式自定义数据库或使用默认物种数据库，均可运行 SDAS PPI --input gene_300.txt --species human --score_threshold 600 --centers 9 --output results_300 SDAS PPI -i gene_300.txt -o ./result --species human --cluster GN kmeans SDAS PPI -i gene_300.txt -o ./result --links_db 9606.protein.links.v12.0.txt --aliases_db 9606.protein.aliases.v12.0.txt --cluster GN kmeans 输入参数说明 参数是否必须默认值描述-i/--input是输入基因名列表文件（基因symbol，每行一个）-o/--output是输出文件夹，未创建则自动新建--species否human物种（human/mouse），（自定义数据库时可忽略该参数，输入--links_db与--aliases_db）--links_db否自定义蛋白互作文件路径（与--species互斥）--aliases_db否自定义蛋白别名文件路径（与--species互斥）--score_threshold否700蛋白间互作分数阈值，在400-900中选择，分数越大可信度越高，网络节点越少，默认700--cluster否GN聚类算法（GN/kmeans/mcl），可多选，使用空格连接，默认GN--centers否5kmeans聚类中心数，默认5--inflation否2.0MCL聚类inflation参数，1.5-3.0，默认2.0 输出结果展示 结果文件 描述 PPI_results.csv 两基因间互作分数，支持Cytoscape导入 cluster_results.csv 输入基因节点连接度及聚类归属 network__visualization.png/pdf 所有基因互作网络图，连线粗细代表互作分数大小，节点大小代表连接度，颜色为聚类 network__top_clusters.png/pdf 节点数量最多的9个cluster分簇绘制网络图，节点数小于50时，circle模式排列，大于50时全局排列（对选定的聚类方式会分别出图） 蛋白互作关系表：PPI_results.csv 每行表示一对基因的互作分数，可直接导入Cytoscape。 | from_gene | to_gene | combined_score | | ---------- | -------- | --------------- | | MEPIA1 | CDH17 | 466 | | LGLA3 | CDH17 | 561 | | PTK2 | CDH17 | 482 | 聚类结果表：cluster_results.csv 每行一个基因，包含其连接度（与多少基因有互作关系）、各聚类算法归属的cluster。 | gene | degree | mcl_cluster | kmeans_cluster | betweenness_cluster | | ------ | ------ | ------------ | --------------- | -------------------- | | MEPIA1 | 6 | 1 | 2 | 5 | | LGLA3 | 5 | 1 | 2 | 5 | 互作网络可视化图: network__visualization.png/pdf：展示所有基因互作网络，节点间连线粗细代表互作分数大小，相同颜色为一个cluster，节点大小表示连接度大小。（对选定的聚类方式会分别出图）。 最大聚类子网圈图: network__top_clusters.png/pdf展示节点数量最多的9个cluster分簇绘制网络图，节点数小于50时，circle模式排列，大于50时全局排列。 性能说明 需要几分钟运行时间，内存消耗1G以内 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/":{"url":"readme/04_manual/cci/","title":"细胞通讯分析","keywords":"","body":"细胞通讯分析细胞通讯分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/01_intro.html":{"url":"readme/04_manual/cci/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 CCI（Cell-Cell Interaction）模块用于空间转录组和单细胞数据的细胞通讯分析，支持cellchat和cellphonedb两种算法，输出多种交互强度、通路、网络等结果。 参考文献 Jin, S., Plikus, M. V., & Nie, Q. (2025). CellChat for systematic analysis of cell–cell communication from single-cell transcriptomics. Nature protocols, 20(1), 180-219. Troulé, K., Petryszak, R., Cakir, B., Cranley, J., Harasty, A., Prete, M., ... & Vento-Tormo, R. (2025). CellPhoneDB v5: inferring cell–cell communication from single-cell multiomics data. Nature Protocols, 1-29. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/02_input.html":{"url":"readme/04_manual/cci/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明cellchat输入文件说明(非必须)pathway.file文件格式说明：cellphonedb输入文件说明(非必须)microenvs_file_path文件格式说明：active_tfs_file_path文件格式说明：degs_file_path文件格式说明：cellphonedb_database数据库说明输入文件示例 h5ad数据格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、空间坐标、细胞类型注释等信息。具体请参考SDAS输入数据格式描述。 cellchat输入文件说明(非必须) pathway.file文件格式说明： pathway.txt：自定义通路文件，无表头，每行一个通路名。 COLLAGENFN1LAMININJA cellphonedb输入文件说明(非必须) microenvs_file_path文件格式说明： microenvs.txt：自定义微环境文件，有表头，每行有两列，分别为细胞类型和空间微环境，列之间以tab键分隔。 cell_type microenvironment PV MMP11 Env1 PV MYH11 Env1 PV STEAP4 Env1 active_tfs_file_path文件格式说明： active_tfs.txt：自定义活性转录因子文件，有表头，每行有两列，分别为细胞类型和TF，列之间以tab键分隔。 cell_type TF EVT_1 ASCL2 EVT_1 ELK3 EVT_1 GATA3 degs_file_path文件格式说明： degs_file.txt: 自定义差异表达基因文件，有表头，列之间以tab键分隔。只提供表达上调的差异基因，前两列必须是细胞类型和基因，其他列非必须。 cell_type gene logFC P.Value adj.P.Val GC BGN 1.605019 3.950450e-131 4.844832e-127 GC HLA-G 1.412923 5.616884e-254 6.888547e-250 GC B2M 1.358709 0.000000e+00 0.000000e+00 cellphonedb_database数据库说明 SDAS内置数据库来源 ：https://github.com/ventolab/cellphonedb-data/tree/master，数据库版本为v5.0.0 自定义构建数据库可参考cellphonedb官网tutorial：\\ https://github.com/ventolab/CellphoneDB/blob/master/notebooks/T0\\_BuildDBfromFiles.ipynb © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/03_cellchat.html":{"url":"readme/04_manual/cci/03_cellchat.html","title":"cellchat算法","keywords":"","body":"cellchat算法用途运行方式输入参数说明输出结果展示调参建议cellchat算法 用途 使用cellchat进行细胞通讯分析 运行方式 SDAS CCI cellchat -i st.h5ad --label_key anno_spotlight -o outdir \\ --add_spatial \\ --bin_size 100 \\ --species human \\ --type truncatedMean 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 h5ad文件，要求有原始表达矩阵 -o / --output 是 输出文件夹 --label_key 是 细胞类群的列名 --layer 否 h5ad存有原始表达矩阵的layer名称 --gene_symbol_key 否 real_gene_name h5ad文件中表示基因名(symbol)的列名（_index 表示用h5ad.var.index） --add_spatial 否 如果分析时需考虑空间信息，则使用”--add_spatial” --bin_size 否 如果使用“--add_spatial”，则需要提供bin_size, 如cellbin,10, 20, 50,100等 --species 否 human cellchat内置的数据库，支持human、mouse、zebrafish，默认‘human’；当指定--cellchat_database时，该参数不起作用 --cellchat_database 否 自定义的cellchat数据库文件路径 --type 否 triMean 计算每个细胞类型的基因表达平均值的方法，triMean或truncatedMean --trim 否 0.1 type为truncatedMean时，可调整trim，trim越小找到的交互越多，trim为0.1时表示去掉两端各10%的极端值后再计算均值 --spatial_coords_scale 否 0.5 应用于空间坐标的全局缩放因子。例如，对于stereo-seq，该值设为0.5，将坐标转为微米，方便结果解读 --scale_distance 否 2 空间距离的归一化因子，比较不同 CellChat 对象之间的通信时，应使用相同的缩放因子。对于单个样本分析，不同的归一化因子不会影响配受体信号的排序 --pathway.file 否 自定义通路文件，用于生成_pathway_communication_network.png/pdf，png为每个pathway一张png，pdf是所有pathway绘制在一个pdf文件,使用“--add_spatial”时，输出空间网络图 --seed 否 42 随机种子 自定义构建数据库可参考cellchat官网tutorial： https://htmlpreview.github.io/?https://github.com/jinworks/CellChat/blob/master/tutorial/Update-CellChatDB.html 输出结果展示 结果文件 描述 _cellchat_LR.csv 互作的配受体结果(没有找到显著配受体时不输出) _cellchat_LR_pathway.csv 配受体富集的通路结果(没有找到显著配受体时不输出) _interaction_strength_circle.png/pdf_interaction_strength_heatmap.png/pdf 展示各细胞类群间配受体互作强度的circle图和heatmap图，同时输出pdf和png _number_of_interactions_circle.png/pdf_number_of_interactions_heatmap.png/pdf 展示各细胞类群间配受体互作数量的circle图和heatmap图，同时输出pdf和png _signalingRole_scatter.png/pdf 展示各细胞类群在信号网络中的角色分布，同时输出pdf和png _pathway_communication_network.png/pdf 指定通路的细胞间网络图，使用“--add_spatial”时，则输出空间网络图，同时输出pdf和png（如果指定通路没有显著富集则不输出） _cellchat.rds 包含细胞通讯结果的rds文件 各细胞类群间配受体互作数量circle图：_number_of_interactions_circle.png/pdf 展示各细胞类群间配受体互作数量，反映互作关系强弱。 圆圈表示细胞类群，连线表示配受体互作，连线粗细代表互作数量，圆圈大小代表该细胞类型参与的总相互作用数量，可直观比较哪些细胞类群之间互作最频繁 各细胞类群间配受体互作强度circle图：_interaction_strength_circle.png/pdf 展示各细胞类群间配受体互作强度，反映信号传递活跃程度。 圆圈表示细胞类群，连线表示配受体互作，连线粗细代表互作强度，圆圈大小代表该细胞类型参与的总相互作用强度，可直观比较哪些细胞类群之间信号传递最活跃 各细胞类群间配受体互作数量热图：_number_of_interactions_heatmap.png/pdf 以热图形式展示互作数量，便于整体比较。 横轴和纵轴均为细胞类群，颜色深浅表示互作数量，颜色越深表示互作越多 各细胞类群间配受体互作强度热图：_interaction_strength_heatmap.png/pdf 以热图形式展示互作强度，便于整体比较。 横轴和纵轴均为细胞类群，颜色深浅表示互作强度，颜色越深表示信号传递越强 信号网络角色分布散点图：_signalingRole_scatter.png/pdf 展示各细胞类群在信号网络中的角色分布。 横轴和纵轴为不同的信号网络特征（如发送者、接收者、调节者等），每个点代表一个细胞类群，点的位置反映其在网络中的功能角色，可识别主要信号发送者和接收者 指定通路的空间网络图：_pathway_communication_network.png/pdf 指定通路的细胞间网络结构，如果加空间信息分析（--add_spatial），则输出指定通路的空间网络图。 横纵坐标为空间坐标，每个点为细胞类群，连线表示通路相关的细胞通讯，连线粗细表示互作强度，节点圆圈大小代表该细胞类型参与的信号相互作用总数，可直观观察特定通路在空间中的分布和作用区域 指定通路的细胞间网络结构图：_pathway_communication_network_nospatial.png/pdf 指定通路的细胞间网络结构。 节点为细胞类群，连线表示通路相关的细胞通讯，连线粗细表示互作强度，节点圆圈大小代表该细胞类型参与的信号相互作用总数，适合无空间信息时观察通路网络结构 调参建议 type参数：推荐使用默认triMean，预测较强互作。如果希望获得更多的交互，可用 truncatedMean 并调整 trim （trim越小交互越多），trim为0.1时表示去掉两端各10%的极端值后再计算均值 scale_distance：空间距离的归一化因子，比较不同 CellChat 对象之间的通信时，应使用相同的缩放因子。对于单个样本分析，不同的归一化因子不会影响配受体信号的排序 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/04_cellphonedb.html":{"url":"readme/04_manual/cci/04_cellphonedb.html","title":"cellphonedb算法","keywords":"","body":"cellphonedb算法用途运行方式输入参数说明输出结果展示cellphonedb算法 用途 使用cellphonedb进行细胞通讯分析 运行方式 SDAS CCI cellphonedb -i st.h5ad --label_key anno_spotlight -o outdir \\ --method statistical \\ --counts_data hgnc_symbol \\ --species human 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 h5ad文件，要求有原始表达矩阵 -o / --output 是 输出文件夹 --label_key 是 细胞类群的列名 --method 否 statistical 分析方法，可选simple，statistical，degs --layer 否 h5ad存有原始表达矩阵的layer名称 --counts_data 否 hgnc_symbol adata.var.index类型，可选hgnc_symbol，ensembl，gene_name --threshold 否 0.1 表达特定配体/受体的细胞百分比阈值，默认0.1即10% --species 否 human SDAS内置的cellphonedb的human数据库，数据库版本为v5.0.0, 当指定--cellphonedb_databa时，该参数不起作用 --cellphonedb_database 否 用户自定义cellphonedb数据库文件路径 --pvalue 否 0.05 显著性阈值（筛选p≤pvalue的互作对），method为statistical时的参数 --subsampling 否 是否降采样，subsampling，method为statistical时的参数 --subsampling_num_cells 否 降采样细胞数,默认为1/3 cells，使用--subsampling时生效，method为statistical时的参数 --microenvs_file_path 否 微环境文件路径（两列：细胞类型、空间微环境） --active_tfs_file_path 否 活性转录因子文件路径（两列：细胞类型、TF） --degs_file_path 否 差异表达基因文件路径（两列：细胞类型、差异基因），method为degs时必须提供 --n_cpus 否 8 线程数 --seed 否 42 随机种子 输出结果展示 结果文件 描述 simple_analysis_means_result_.txtstatistical_analysis_means_result_.txtdegs_analysis_means_result_.txt 所有配体-受体对的平均表达量是矩阵。每一行为一个配体-受体对，每一列为细胞类型组合，数值为平均表达量 simple_analysis_deconvoluted_.txtstatistical_analysis_deconvoluted_.txtdegs_analysis_deconvoluted_.txt 各细胞类型的平均表达量，用于展示每个细胞类型的表达情况 simple_analysis_deconvoluted_percents_.txtstatistical_analysis_deconvoluted_percents_.txtdegs_analysis_deconvoluted_percents_.txt 各细胞类型的表达比例，反映每个配体-受体对在不同细胞类型中的表达百分比 simple_analysis_interaction_scores_.txtstatistical_analysis_interaction_scores_.txtdegs_analysis_interaction_scores_.txt 细胞类型间交互强度评分，数值越大表示细胞间的配受体互作越强 statistical_analysis_significant_means_.txtdegs_analysis_significant_means_.txt 显著交互的平均表达量 statistical_analysis_pvalues_.txt statistical方法下，所有配体-受体对的显著性p值矩阵 cellphonedb_heatmap_.png/pdf 显著交互热图，展示所有细胞类群间显著配受体互作的强度，颜色深浅反映交互强度，当method为statistical和degs时输出 cellphonedb输出的显著互作热图：cellphonedb_heatmap_.png/pdf 展示所有细胞类群间显著配受体互作的热图，颜色深浅反映交互强度。 横轴和纵轴均为细胞类群，颜色深浅表示配受体互作强度，颜色越深表示互作越强。可快速比较不同细胞类群间的通讯活跃程度 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/cci/05_performence.html":{"url":"readme/04_manual/cci/05_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 cellchat算法是单线程 cellphonedb算法使用n_cpus控制并行线程数，该性能测试使用n_cpus=8 运行时间和内存需求与细胞数目相关，即细胞数目越多所需时间越长，内存越大 运行时间：在细胞数目较多时（30w+以上），cellchat > cellphonedb 内存： 在细胞数目较多时（30w+以上），cellchat > cellphonedb © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/trajectory.html":{"url":"readme/04_manual/trajectory.html","title":"轨迹分析","keywords":"","body":"轨迹分析轨迹分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/trajectory/01_intro.html":{"url":"readme/04_manual/trajectory/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 轨迹分析用于推断细胞在空间或发育过程中的动态变化轨迹，揭示细胞状态转变、发育分化等生物学过程。该模块使用monocle3算法进行轨迹分析， 支持空间转录组和单细胞数据的轨迹推断，自动输出多种轨迹相关结果。 参考文献 Cao, J., Spielmann, M., Qiu, X., Huang, X., Ibrahim, D. M., Hill, A. J., ... & Shendure, J. (2019). The single-cell transcriptional landscape of mammalian organogenesis. Nature, 566(7745), 496-502. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/trajectory/02_input.html":{"url":"readme/04_manual/trajectory/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例rds数据格式说明gene_file文件格式说明（非必须）：输入文件示例 rds数据格式说明 st.rds：空间转录组表达矩阵Seurat对象，要求包含原始表达矩阵、基因名等信息。具体请参考SDAS输入数据格式描述。 gene_file文件格式说明（非必须）： gene.txt：自定义基因列表文件，无表头，每行一个基因名，用于展示自定义基因随拟时序变化的表达趋势图 ABLIM1FAUCLMNRBBP4HCG14 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/trajectory/03_monocle3.html":{"url":"readme/04_manual/trajectory/03_monocle3.html","title":"monocle3算法","keywords":"","body":"monocle3算法用途运行方式输入参数说明输出结果展示调参建议monocle3算法 用途 利用monocle3 算法对空间转录组和单细胞数据进行轨迹推断，自动输出多种轨迹相关结果。 运行方式 使用细胞注释后的h5ad，准备rds文件 SDAS dataProcess h5ad2rds -i st.h5ad -o outdir 运行monocle3 SDAS trajectory monocle3 -i st.rds -o outdir --root_key anno_spotlight --root CAF_DES \\ --gene_symbol_key real_gene_name \\ --batch_key sampleID 输入参数说明 参数 是否必须 默认值 描述 -i / --input 是 rds文件，要求有原始表达矩阵 -o / --output 是 输出文件夹 --root_key 是 meta.data中根节点所在的列名称 --root 是 设置为根节点的名称 --assay 否 rds文件中用于分析的assay名称，若不设置则用当前默认assay --gene_symbol_key 否 real_gene_name rds文件中基因名(symbol)的列名（meta.features），_index 表示用矩阵的列名 --batch_key 否 进行批次校正的meta.data列名，不输入则不做去批次 --resolution 否 leiden聚类的resolution参数，不输入则算法会自适配 --use_existing_umap_cluster 否 使用rds已有的umap和cluster信息 --umap_key 否 umap 输入rds存储umap信息的名称 --cluster_key 否 leiden 输入rds存储cluster信息的名称 --deg 否 分析随拟时序变化的差异基因则输入”--deg” --n_cpus 否 8 多线程数 --top_gene_num 否 5 随拟时序变化的top差异基因数目的表达图 --gene_file 否 自定义基因列表文件路径，画基因随拟时序变化的表达趋势图 --gene_color_label 否 pseudotime 基因图展示的列的名称 --pval_cutoff 否 0.05 差异基因筛选p值 --qval_cutoff 否 0.05 差异基因筛选q值 --seed 否 42 随机种子 输出结果展示 结果文件 描述 _dimension.png/pdf 降维图，展示细胞在低维空间的分布结构 _dimension_color_by_batch.png/pdf 以批次信息展示的降维图（有做批次校正时输出），用于评估批次效应 _cluster.png/pdf 聚类图，展示细胞聚类分布情况 _roots.png/pdf root图，显示轨迹分析的根节点位置 _pseudotime.png/pdf 拟时序图，展示细胞的拟时序分布 _top_genes_in_pseudotime.png/pdf 拟时序变化的top基因表达趋势图 _custom_genes_in_pseudotime.png/pdf 拟时序变化的自定义基因表达趋势图 _monocle3.rds 包含轨迹分析结果的rds文件 _pseudotime.csv 细胞的拟时序结果，记录每个细胞的拟时序值 _deg_trajectory.xls 随拟时序变化的所有基因的结果 降维图：_dimension.png/pdf 展示细胞在低维空间的分布结构,反映整体异质性和分群结构 聚类图：_cluster.png/pdf 展示细胞聚类分布，反映整体异质性和分群结构 root图：_roots.png/pdf 展示轨迹分析的根节点，标记轨迹推断的起始点（根节点），用于后续拟时序排序 拟时序图：_pseudotime.png/pdf 展示细胞拟时序分布,细胞按推断的发育/转化顺序着色，反映动态变化过程 拟时序变化的top基因表达趋势图：_top_genes_in_pseudotime.png/pdf 展示拟时序变化最显著的top基因表达趋势 拟时序变化的自定义基因表达趋势图：_custom_genes_in_pseudotime.png/pdf 展示用户指定基因在拟时序过程中的基因表达趋势 调参建议 monocle3的轨迹分析一般需以细胞亚型精准注释为前提。通过亚型划分，算法可排除无关细胞干扰，聚焦于具有发育连续性的细胞群体，从而推断符合生物学逻辑的分化路径。实际分析中，推荐选取特定细胞群体，不要使用全片进行分析，同时可降低运行时间和内存。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/trajectory/04_performence.html":{"url":"readme/04_manual/trajectory/04_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 monocle3使用n_cpus控制并行进程数，每个进程固定1个线程，该性能测试使用n_cpus=8，即8*1=8线程，该测试是在--deg情况下统计的 运行时间和内存与细胞数有关，细胞数越多所需时间越长，内存越大 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/tf.html":{"url":"readme/04_manual/tf.html","title":"转录因子分析","keywords":"","body":"转录因子分析转录因子分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/tf/01_intro.html":{"url":"readme/04_manual/tf/01_intro.html","title":"简介","keywords":"","body":"简介参考文献简介 本模块基于pyscenic分析细胞-基因表达矩阵，预测转录因子（TFs）与靶基因之间的相互作用，结合转录因子活性热图、特异性表达图等，探索转录因子调控网络在细胞亚群中的作用，构建细胞内的基因调控图谱。 参考文献 Van de Sande, B., Flerin, C., Davie, K., De Waegeneer, M., Hulselmans, G., Aibar, S., ... & Aerts, S. (2020). A scalable SCENIC workflow for single-cell gene regulatory network analysis. Nature protocols, 15(7), 2247-2276. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/tf/02_input.html":{"url":"readme/04_manual/tf/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明celltype_list细胞类型列表文件（非必须） TF_list转录因子列表文件（非必须）转录因子数据库说明输入文件示例 h5ad数据格式说明 test.h5ad：空间转录组表达矩阵AnnData对象，要求包含原始表达矩阵、细胞类型注释等信息。具体请参考SDAS输入数据格式描述。 celltype_list细胞类型列表文件（非必须） celltype_list.txt:自定义细胞类型列表文件，无表头，每行一个细胞类型 FibroblastT/NK TF_list转录因子列表文件（非必须） TF_list.txt:自定义转录因子列表文件，无表头，每行一个转录因子 CLOCK(+)E2F3(+)EBF1(+)E1S1(+) 转录因子数据库说明 内置数据库来源： 转录因子列表（TF list）：包含目标物种的所有已知转录因子基因名https://github.com/aertslab/pySCENIC/tree/master/resources 参考数据库（Feather文件）：存储基因与转录因子结合位点（motif）的调控潜能排序。https://resources.aertslab.org/cistarget/databases/ 转录因子注释文件：关联 motif 与对应转录因子的映射关系。https://resources.aertslab.org/cistarget/motif2tf/ 自定义数据库构建可参考： pySCENIC官方文档：https://pyscenic.readthedocs.io/en/latest/ CistTarget数据库说明：https://resources.aertslab.org/cistarget/ © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/tf/03_pyscenic.html":{"url":"readme/04_manual/tf/03_pyscenic.html","title":"pyscenic算法","keywords":"","body":"pyscenic算法用途运行方式输入参数说明输出结果展示pyscenic算法 用途 本模块基于pyscenic分析细胞-基因表达矩阵，预测转录因子（TFs）与靶基因之间的相互作用 运行方式 SDAS TF --input test.h5ad --output TF_result --label_key anno_cell2location --slice_key group --celltype_list celltype.txt --species human --n_cpus 24 输入参数说明 参数是否必须默认值描述-i/--input是输入h5ad文件（可经过筛选后的）-o/--output是输出文件夹，未创建则自动新建--label_key是指定h5ad.obs中细胞类型或分组的obs列名--gene_symbol_key否real_gene_name指定h5ad中表示基因名(symbol)的列名--slice_key否多h5ad.obs中分层分组的列名--celltype_list否需分析的细胞亚型列表文件路径。至少指定2种细胞类型，否则画图会报错。--TF_list否需关注的TF列表文件路径--species否human物种，human/mouse--db_names否motif/调控数据库文件路径，例hg38/10kbp*.feather--motif否motif注释文件路径，例hg38/motifs-*.tbl--n_cpus否24并行线程数--method否grnboost2GRN推断方法，grnboost2/genie3 输出结果展示 结果文件描述_filtered.h5ad（中间文件）使用目标celltype类型筛选后的h5ad文件.loom（中间文件）基于h5ad构建的细胞-基因表达矩阵文件，pyscenic输入文件adj.tsv（中间文件）pyscenic构建的基因调控网络边文件，用于pyscenic ctx 构建TF-targets网络sce_regulon.gmt（中间文件）pyscenic构建的TF-targets网络，用于pyscenic aucell 计算Regulons（调控子）活性sce_regulon_AUC.loompyscenic输出的regulon调控结果文件，每个细胞的活性得分, 用于后续可视化Regulon_Heatmap.png/pdfregulon活性热图，展示各细胞/分组的regulon活性Binary_Regulon_Heatmap.png/pdfregulon二值化活性热图，便于细胞亚群特异性分析RSS.pdf/RSS_group*.png/pdfregulon特异性得分RSS热图/分组热图Spatial_Activity_Maps.png/pdfregulon在空间上的活性热图，仅在--TF_list参数指定后绘制 regulon活性热图: Regulon_Heatmap.png/pdf 每行一个regulon，每列一个细胞/分组，颜色表示AUC活性得分。用于比较同一Regulons在不同细胞中的活性，寻找Regulons特异性活化的细胞亚群等。 regulon二值化活性热图:Binary_Regulon_Heatmap.png/pdf regulon活性二值化后热图，黑色即该细胞开放该Regulons，便于细胞亚群特异性分析。 regulon特异性得分RSS热图/分组热图: RSS.png/pdf RSS_group*.png/pdfregulon在不同分组/细胞类型中的特异性得分RSS热图。圆圈大小表示RSS高低，颜色梯度表示标准化后的Z值大小；每行对应一个调控子，每列对应一种细胞类型。同一细胞类型内可直接比较调控子的特异性RSS，不同细胞类型可比较Z值。 regulon空间活性热图: Spatial_Activity_Maps.png/pdf regulon在空间上的活性分布，仅在空间转录组数据及输入--TF_list参数时输出。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/tf/04_performence.html":{"url":"readme/04_manual/tf/04_performence.html","title":"性能测试","keywords":"","body":"性能测试运行时间与内存占用性能测试 运行时间与内存占用 建议：pyscenic构建转录因子与基因之间的共表达网络需要用到随机森林算法，当细胞数增加时，运行时间和内存指数增加。 推荐分析时，针对目标细胞先进行筛选再进行分析。 运行时间和内存与细胞数成正比，细胞数越多，资源需求越高 推荐优先筛选目标细胞亚群后分析 参考性能（n_cpus=24） 样本 细胞数 运行时间(h) 内存(G) sample1 20629 7.8 23 sample2 21500 13.7 29 sample3 81843 23 79 sample4 84510 37.5 108 sample5 321856 >96 >200 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/":{"url":"readme/04_manual/spatial_relate/","title":"细胞空间距离关系分析","keywords":"","body":"细胞空间距离关系分析细胞空间距离关系分析 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/01_intro.html":{"url":"readme/04_manual/spatial_relate/01_intro.html","title":"简介","keywords":"","body":"简介算法测评经验参考文献简介 空间关系分析旨在识别空间转录组数据中细胞类型间的相互作用关系和空间分布模式。通过对空间转录组数据的深入挖掘，可以揭示细胞类型间的邻近、共现、富集等空间关系，帮助理解组织结构和功能的空间异质性。支持Squidpy和CRAWDAD两种方法。 算法测评经验 如果希望快速获得结果，建议首先尝试使用 Squidpy方法。Squidpy 提供了多种空间关系分析方法，包括邻域富集分析、共现性分析和Ripley's统计，适合全面的空间关系探索。CRAWDAD 提供了基于距离尺度的空间关系分析方法，能够识别细胞类型间的相互作用关系和空间共变趋势，特别适合识别显著的细胞邻近或回避现象。 参考文献 dos Santos Peixoto, R., Miller, B. F., Brusko, M. A., Aihara, G., Atta, L., Anant, M., ... & Fan, J. (2025). Characterizing cell-type spatial relationships across length scales in spatially resolved omics data. Nature Communications, 16(1), 350. Palla, G., Spitzer, H., Klein, M., Fischer, D., Schaar, A. C., Kuemmerle, L. B., ... & Theis, F. J. (2022). Squidpy: a scalable framework for spatial omics analysis. Nature methods, 19(2), 171-178. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/02_input.html":{"url":"readme/04_manual/spatial_relate/02_input.html","title":"输入文件示例","keywords":"","body":"输入文件示例h5ad数据格式说明输入文件示例 h5ad数据格式说明 st.h5ad：空间转录组表达矩阵AnnData对象，要求包含空间坐标、细胞类型或区域聚类注释等信息。具体请参考SDAS输入数据格式描述 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/03_squidpy.html":{"url":"readme/04_manual/spatial_relate/03_squidpy.html","title":"Squidpy算法","keywords":"","body":"Squidpy算法用途运行方式输入参数说明输出结果展示结果解读说明调参建议Squidpy算法 用途 使用 Squidpy 工具包进行全面的空间组学分析，包括细胞交互模式（邻里富集）、共现性分析以及细胞类型的空间分布模式评估（Ripley's 统计）。 运行方式 SDAS spatialRelate squidpy -i st.h5ad -o outdir --label_key anno_cell2location \\ --spatial_coords_scale 0.5 \\ --bin_size 50.0 \\ --n_neighs 9 \\ --coord_type grid \\ --n_perms_enrichment 1000 \\ --cooccurrence_interval '100,1000,10' \\ --n_simulations_ripley 100 \\ --ripley_modes 'F,G,L' \\ --n_cpus 24 \\ --seed 42 输入参数说明 Squidpy 参数 是否必须 默认值 描述 -i / --input 是 输入的 AnnData h5ad 文件路径。要求包含空间坐标和细胞注释。 -o / --output 是 分析结果的输出文件夹路径。 --label_key 是 AnnData 对象中 (adata.obs) 用于细胞类型或区域聚类注释的列名。 --spatial_coords_scale 否 0.5 应用于空间坐标的全局缩放因子。例如，对于stereo-seq，该值设为0.5，将坐标转为微米，方便结果解读。 --min_cells_per_type 否 20 为纳入分析，每种细胞类型/聚类所需的最少细胞（或 spot）数量。重要：建议设置为20及以上，过小的值可能导致分析不稳定。 --n_cpus 否 8 并行计算时可使用的 CPU核心数。CPU核数越多，运行时间相应较少，可根据计算资源合理设置。 --bin_size 否 50.0 原始数据坐标单位中 spot 的直径。此值将与 spatial_coords_scale 相乘用于确定 spatial_scatter 图中的最终绘图标记大小。 --n_neighs 否 9 sq.gr.spatial_neighbors 中用于构建空间图的邻居数量。 --coord_type 否 grid 传递给 squidpy.gr.spatial_neighbors 的 coord_type 参数。可选值为：'generic' (适用于不规则排列的空间数据点，基于实际坐标计算邻接) 或 'grid' (默认，适用于排列在规则网格上的数据点，基于网格位置构建邻接，通常更快)。 --n_perms_enrichment 否 1000 邻域富集分析中用于置换检验的次数，以评估观察到的富集/耗竭的显著性。必须为正整数。 --cooccurrence_interval 否 \"100,1000,10\" 共现分析的距离区间定义，格式为 \"起始距离,结束距离,点数\"。例如 \"50,250,10\" 表示从距离50到250，均匀取10个距离点进行分析。起始距离必须非负，结束距离必须大于起始距离，点数必须为正整数。 --n_simulations_ripley 否 100 计算 Ripley's F, G, 或 L 函数时，用于生成置信区间的模拟次数。必须为正整数。 --ripley_modes 否 \"F,G,L\" 需要计算的 Ripley 统计模式，以逗号分隔 (例如 \"F,G\", \"L\")。支持的模式包括 \"F\", \"G\", \"L\"。 --seed 否 42 用于可复现性的随机种子。必须为非负整数。 输出结果展示 结果文件 描述 _squidpy_spatial_scatter.pdf/png 根据 --label_key 对细胞/spot 着色的空间分布图。 _squidpy_nhood_enrichment_zscores.csv 邻域富集分析的 Z-score 矩阵，表示细胞类型间的空间邻近关系强度。 _squidpy_nhood_enrichment.pdf/png 邻域富集分析 Z-score 矩阵的热图可视化。 _squidpy_co_occurrence_scores_full.csv 主要定量结果。该文件为长表格式，记录了每一对细胞类型在每个距离分箱下的原始共现得分，字段包括参考细胞类型、邻居细胞类型、距离、距离区间索引、共现得分。 _squidpy_co_occurrence_all_types.pdf 所有细胞类型对（或指定细胞类型）的共现概率随距离变化的趋势图 (多页 PDF)。 _squidpy_co_occurrence_plots_png/ (文件夹) 包含每个细胞类型与其它类型共现趋势的独立 PNG 图片。 _squidpy_co_occurrence.pdf/png 单个细胞类型的共现趋势图。 _squidpy_ripley__function.pdf/png Ripley's 统计指定模式 (F, G, 或 L) 的结果图，用于评估细胞类型的空间分布模式（聚集、分散或随机）。为每个在 --ripley_modes 中指定的模式生成一个文件。 _squidpy_processed.h5ad 经过 Squidpy 分析和预处理后，包含所有计算结果（通常存储在 adata.uns 中）的最终 AnnData 对象。 邻域富集分析Z-score矩阵：_squidpy_nhood_enrichment_zscores.csv Squidpy输出结果展示细胞类型间的空间邻近关系强度，Z-score值表示相对于随机分布的富集或耗竭程度 B Endo Epi Fib Mye NK T B 0.0 -0.5 -1.2 0.8 1.5 2.1 -0.3 Endo -0.5 0.0 0.7 -0.2 -1.1 0.4 0.9 Epi -1.2 0.7 0.0 1.8 -0.6 -0.8 0.3 Fib 0.8 -0.2 1.8 0.0 0.5 -0.1 1.2 Mye 1.5 -1.1 -0.6 0.5 0.0 0.7 -0.4 NK 2.1 0.4 -0.8 -0.1 0.7 0.0 1.6 T -0.3 0.9 0.3 1.2 -0.4 1.6 0.0 共现性分析原始结果表：_squidpy_co_occurrence_scores_full.csv 记录每一对细胞类型在每个距离分箱下的原始共现得分，适用于后续自定义分析和可视化。 from_celltype to_celltype distance distance_interval_index cooccurrence_score B B 100.0 0 0.5327037 B B 200.0 1 0.5388954 B B 300.0 2 0.47285548 B B 400.0 3 0.44997987 B B 500.0 4 0.41206497 B Endo 100.0 0 0.12482233 B Endo 200.0 1 0.1646443 B Endo 300.0 2 0.15779616 B Endo 400.0 3 0.20279443 B Epi 100.0 0 0.06660331 邻域富集分析热图：_squidpy_nhood_enrichment.png 可视化邻域富集分析Z-score矩阵，图中颜色表示不同细胞类型对之间的空间邻近关系强度 空间分布散点图：_squidpy_spatial_scatter.png 根据细胞类型对细胞/spot着色的空间分布图，展示不同细胞类型在空间中的分布模式 共现性分析趋势图：_squidpy_co_occurrence_B.png 展示B细胞与其他细胞类型的共现概率随距离变化的趋势图，X轴为距离，Y轴为共现概率 Ripley's F函数分析：_squidpy_ripley_F_function.png 展示细胞类型的空间分布模式，与随机分布的期望和置信区间进行比较 结果解读说明 邻域富集分析Z-score：正值表示富集（细胞类型倾向于邻近），负值表示耗竭（细胞类型倾向于远离），绝对值越大表示关系越显著 共现性分析：展示细胞类型随距离变化的共现模式，有助于理解细胞类型间的空间相互作用 Ripley's统计：评估细胞类型的空间分布模式，F/G/L函数值高于随机期望表示聚集分布，低于随机期望表示分散分布 调参建议 若样本细胞类型较少或数据稀疏，建议调整n_perms_enrichment和n_simulations_ripley参数以获得更稳定的结果 n_perms_enrichment：邻域富集分析的置换次数，建议根据数据规模调整，数据量大时可适当减少以节省计算时间 n_simulations_ripley：Ripley's统计的模拟次数，影响置信区间的准确性，可根据需要调整 cooccurrence_interval：共现分析的距离区间，建议根据细胞类型的大小和空间分布特征调整 bin_size：影响空间散点图的点大小，可根据数据密度和可视化需求调整 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/04_crawdad.html":{"url":"readme/04_manual/spatial_relate/04_crawdad.html","title":"CRAWDAD算法","keywords":"","body":"CRAWDAD算法用途运行方式输入参数说明输出结果展示结果解读说明调参建议CRAWDAD算法 用途 利用 CRAWDAD (Correlated Analysis of WORkflow-Derived Spatial Associations and Distances) R包分析空间分辨转录组数据中细胞类型间的相互作用关系和空间共变趋势，识别显著的细胞邻近或回避现象。 运行方式 SDAS spatialRelate crawdad -i st.h5ad -o outdir --label_key anno_cell2location \\ --spatial_coords_scale 0.5 \\ --crawdad_scales_definition '100,1000,10' \\ --crawdad_perms 10 \\ --crawdad_neighborhood_dist 50 \\ --n_cpus 24 \\ --seed 42 输入参数说明 CRAWDAD 参数 是否必须 默认值 描述 -i / --input 是 输入的 AnnData h5ad 文件路径。要求包含空间坐标和细胞注释。 -o / --output 是 分析结果的输出文件夹路径。 --label_key 是 AnnData 对象中 (adata.obs) 用于细胞类型或区域聚类注释的列名。 --spatial_coords_scale 否 0.5 应用于空间坐标的全局缩放因子。例如，对于stereo-seq，该值设为0.5，将坐标转为微米，方便结果解读 --min_cells_per_type 否 20 为纳入分析，每种细胞类型/聚类在筛选后所需的最少细胞（或 spot）数量。重要：建议设置为20及以上，过小的值可能导致分析不稳定。 --crawdad_neighborhood_dist 否 50 CRAWDAD 分析中用于定义细胞邻域的距离（通常单位为微米）。影响 findTrends 函数中邻居细胞的识别。必须为正整数。重要：此参数应与细胞大小和空间分布特征匹配，建议设置为细胞直径的1-3倍。 --crawdad_scales_definition 否 \"100,1000,10\" CRAWDAD 分析的距离尺度定义，格式为 \"起始距离,结束距离,点数\"。例如 \"50,500,10\" 表示从距离50到500，均匀取10个距离点进行分析。起始距离必须非负，结束距离必须大于起始距离，点数必须为正整数。重要：起始距离应大于或等于crawdad_neighborhood_dist。 --crawdad_perms 否 10 CRAWDAD R脚本中用于计算相互作用p值的置换次数。增加此值会提高p值的准确性但增加计算时间。必须为正整数。 --n_cpus 否 8 并行计算时可使用的 CPU核心数。CPU核数越多，运行时间相应减少，可根据计算资源合理设置。 --seed 否 42 用于可复现性的随机种子。必须为非负整数。 输出结果展示 结果文件 描述 _crawdad_summary_coloc_dotplot.pdf/png 汇总共定位点图：展示显著的细胞类型对共定位或互斥关系。点的大小/颜色代表强度/方向。视觉效果经过优化（点大小、X轴标签）。 _crawdad_spatial_cluster_plot.pdf/png 空间聚类图：按细胞类型 (label_key) 着色显示各类细胞的空间排布。点大小根据数据量动态调整。 _crawdad_trend_plots_all.pdf 互作趋势图 (多页PDF): 每页对应一个参考细胞类型，含空间分布子图 (点大小动态调整，保持长宽比) 和互作强度 (Z-score) 随距离变化子图。 _crawdad_trend_plots_png/ (文件夹) 与上述PDF每页内容相同的独立PNG图片。 _crawdad_trend_plot_ref_.png 单个参考细胞类型的互作趋势组合图。 _crawdad_melted_results.csv 主要定量结果: 包含细胞类型间详细互作分析数据 (如参考细胞、邻居细胞、距离尺度、Z-score)。 _crawdad_zsig.csv Bonferroni 校正后的Z-score显著性阈值 (zsig)。 _crawdad_r_stdout.log R脚本标准输出日志 (INFO级别，带时间戳)。 _crawdad_r_stderr.log R脚本标准错误日志 (WARNING/ERROR级别，带时间戳，含错误详情)。 (_processed_for_crawdad.h5ad) (中间文件) 预处理后传递给R脚本的AnnData文件。 主要定量结果表格：_crawdad_melted_results.csv CRAWDAD输出结果展示细胞类型间详细互作分析数据，包含参考细胞、邻居细胞、距离尺度、Z-score等关键互作指标 perm neighbor Z scale reference 1 B 1.05670532268942 100 B 2 B -1.45780531937283 100 B 3 B -2.7310679139005 100 B 4 B -1.76600222336501 100 B 5 B -0.122214856981382 100 B 6 B -0.215950198738648 100 B 7 B -1.34972501073846 100 B 8 B -1.38061633431226 100 B 9 B -1.56577575976306 100 B 10 B -1.71982948316056 100 B 1 Endo 0.586389142807096 100 B 2 Endo 0.953148492138181 100 B 3 Endo 1.18876625358954 100 B 4 Endo 0.71926735855275 100 B 5 Endo 0.752573768964804 100 B 6 Endo 1.32419648335896 100 B 7 Endo 1.46020965216509 100 B 8 Endo 0.819291421388121 100 B 9 Endo 1.87180663929578 100 B 汇总共定位点图：_crawdad_summary_coloc_dotplot.png 展示显著的细胞类型对共定位或互斥关系，点的大小/颜色代表强度/方向 空间聚类图：_crawdad_spatial_cluster_plot.png 按细胞类型着色显示各类细胞的空间排布，点大小根据数据量动态调整 互作趋势图：_crawdad_trend_plot_ref_B.png 展示B细胞与其他细胞类型的空间分布和互作强度随距离变化趋势。在趋势图中，与参考细胞类型基于 zsig 判断为显著互作的邻居细胞类型会赋予彩色，其余细胞类型则显示为浅灰色。在空间分布图中，不显著互作的细胞类型则没有显示。 结果解读说明 Z-score：正值表示共定位（细胞类型倾向于在相同区域出现），负值表示互斥（细胞类型倾向于在不同区域出现），绝对值越大表示关系越显著 距离尺度：不同scale值代表不同的空间分析尺度，有助于理解细胞类型在不同空间分辨率下的相互作用模式 显著性阈值：zsig值用于判断统计显著性，超过此阈值的Z-score被认为是显著的空间关系 调参建议 若样本细胞类型较少或数据稀疏，建议调整crawdad_perms参数以获得更稳定的结果，或调整crawdad_scales_definition以适应数据特征 crawdad_neighborhood_dist：通常设置为细胞直径的1-3倍。例如，细胞直径为20μm时，可设置为20-60μm crawdad_perms：置换次数，增加此值会提高p值的准确性但增加计算时间，建议根据数据规模调整 crawdad_scales_definition：距离尺度定义，建议根据细胞类型的大小和空间分布特征调整，起始距离应大于细胞直径 spatial_coords_scale：空间坐标缩放因子，对于stereo-seq数据建议设为0.5，将坐标转为微米单位 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/spatial_relate/05_performence.html":{"url":"readme/04_manual/spatial_relate/05_performence.html","title":"性能测试","keywords":"","body":"性能测试Stereo-seq测试数据运行时间与内存占用性能测试 Stereo-seq测试数据 样本 细胞数目 细胞类群(个) sample1_bin100 17,884 29 sample1_bin50 70,761 38 sample1_bin20 439,383 39 sample1_cellbin 134,703 39 sample2_bin100 23,061 11 sample2_bin50 91,106 11 sample2_bin20 5,643,322 11 运行时间与内存占用 Squidpy：运行时间/内存随着细胞数增加而增大，不同binsize运行时间均在1小时以内可完成， bin20的内存会显著增加； CRAWDAD：运行时间/内存随着细胞数增加而增大，不同binsize内存均在10G以内，bin20的运行时间会显著增加； CRAWDAD：运行时间受--crawdad_perms影响极大，增加此值会提高p值的准确性但增加计算时间。默认推荐10 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/bulk_validate/":{"url":"readme/04_manual/bulk_validate/","title":"公共数据库验证","keywords":"","body":"公共数据库验证公共数据库验证 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/bulk_validate/00_intro.html":{"url":"readme/04_manual/bulk_validate/00_intro.html","title":"简介","keywords":"","body":"简介模块算法整体介绍验证策略与流程第0步：数据准备验证方式1：基因集验证验证方式2：细胞类型验证参考文献简介 公共数据库验证模块是SDAS软件的重要组成部分，旨在通过公开的Bulk RNA-Seq数据集和临床数据验证空间转录组学分析结果的生物学意义和临床相关性。该模块提供了三种核心分析方法：Bulk RNA-Seq数据免疫浸润分析、基因集打分分析以及Kaplan-Meier生存分析。通过系统性的验证框架，支持从空间转录组学数据中发现的生物学线索在临床样本中的验证，为空间转录组学研究的临床转化提供重要支撑。 模块算法整体介绍 1. 免疫浸润分析 通过多种算法（如CIBERSORTx、EPIC等）评估肿瘤微环境中的免疫细胞浸润情况，输出免疫细胞比例和热图，帮助研究人员深入理解免疫细胞在肿瘤发生发展中的作用机制。 2. 基因集打分分析 使用多种算法（如GSVA、ssGSEA等）对自定义基因集在Bulk RNA-Seq数据中的活性进行评分，输出标准化的富集分数和热图，便于评估基因集的生物学功能及其在疾病进程中的意义。 3. Kaplan-Meier生存分析 结合免疫浸润和基因集打分结果，进行单因素生存分析，输出生存曲线图，帮助研究人员评估特定特征与临床预后的关联性，为临床决策提供数据支撑。 验证策略与流程 第0步：数据准备 数据来源：从公开数据库获取包含临床信息的Bulk RNA-Seq数据集 推荐数据库：TCGA (UCSC Xena)、GEO等 数据要求：需包含完整的临床信息，并按SDAS输入格式要求进行预处理 数据格式：支持标准化的基因表达矩阵和临床信息表格 验证方式1：基因集验证 根据基因集中基因数量的不同，采用不同的验证策略： 单基因验证（基因数为1） 应用场景：空间转录组学数据中发现的特定标记基因表达的细胞类型 典型示例：CD20+ B细胞、SAA+肝细胞等 分析方法：Kaplan-Meier生存分析（即survivalKM） 数据来源：基因表达值（可来自Bulk RNA-Seq数据集或IHC实验） 验证目标：验证单个基因的表达水平与临床预后的关联性 基因模块验证（基因数为3-8或者更多） 应用场景：空间转录组学数据中发现的基因特征 典型示例：TLS（三级淋巴结构）亚型、肿瘤亚型、活化B细胞亚型等 分析方法：模块评分计算结合Kaplan-Meier生存分析（即geneSetScore + survivalKM） 验证目标：验证基因模块的整体表达模式与临床预后的关联性 验证方式2：细胞类型验证 应用场景：空间转录组学数据中发现的特定细胞类型 验证要求：目标细胞类型需在xCell、CIBERSORTx或其他免疫浸润算法的参考集中存在 分析流程：Bulk RNA-Seq数据的免疫浸润分析，随后进行Kaplan-Meier生存分析（即immuneScore + survivalKM） 验证目标：验证特定细胞类型的丰度与临床预后的关联性 参考文献 Zeng, D., Ye, Z., Shen, R., Yu, G., Wu, J., Xiong, Y., ... & Liao, W. (2021). IOBR: multi-omics immuno-oncology biological research to decode tumor microenvironment and signatures. Frontiers in immunology, 12, 687975. © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/bulk_validate/01_immune.html":{"url":"readme/04_manual/bulk_validate/01_immune.html","title":"免疫浸润分析模块","keywords":"","body":"免疫浸润分析模块用途输入文件示例运行方式输入参数说明输出结果展示免疫浸润分析模块 用途 本模块基于IOBR等R包，对bulk RNA-Seq数据进行肿瘤微环境免疫浸润分析，支持多种主流免疫浸润算法，并输出标准化的结果表格和可视化图表。 支持的免疫浸润及基质评分算法： CIBERSORT: 基于线性支持向量回归的免疫细胞浸润分析 EPIC: 基于约束最小二乘法的免疫细胞浸润分析 MCPcounter: 基于基因集富集分析的免疫细胞浸润分析 xCell: 基于基因集变异分析的免疫细胞浸润分析 TIMER: 基于去卷积算法的免疫细胞浸润分析 quanTIseq: 基于定量免疫细胞浸润分析 ESTIMATE: 基于基因表达谱的肿瘤纯度评估 输入文件示例 expression表达矩阵文件：每行一个基因名，每列一个样本名，数值为对应的表达量，tab分割 GeneID Sample1 Sample2 Sample3 GENE1 1.234 2.345 3.456 GENE2 4.567 5.678 6.789 clinical临床信息文件：每行一个样本名，每列一个临床特征，tab分割 SampleID tissue_type.samples age gender Sample1 Tumor 45 Male Sample2 Normal 50 Female Sample3 Tumor 55 Male 运行方式 SDAS bulkValidate ​immuneScore --expression fpkm.txt --clinical clinical.txt --group_col tissue_type.samples --group_type discrete --output result_dir 输入参数说明 参数 是否必需 默认值 描述 --expression 是 表达矩阵文件路径。制表符分隔，行：基因ID，列：样本ID，值为FPKM/TPM等，不可为原始counts，不可log --clinical 是 临床信息文件路径。制表符分隔，行：样本ID，列：临床特征 --group_col 是 分组列名（需在临床信息文件中存在） --output 是 输出目录路径 --group_type 否 discrete 分组类型：discrete/continuous，默认discrete --group_type分组类型说明 离散分组 (discrete)：直接使用临床信息中的分类变量进行分组，例如：Tumor vs Normal, Stage I vs Stage II vs Stage III 连续分组 (continuous)：将连续变量按分位数分为三组：Low, Medium, High 分位数：0%, 30%, 70%, 100% 输出结果展示 结果文件 描述 tme_combine.txt 所有免疫浸润方法的合并结果 tme_heatmap.png/pdf TME免疫浸润热图 StromaScore_heatmap.png/pdf 基质评分热图 _stacked_bar.png/pdf 各方法免疫细胞比例堆积柱状图 _grouped_boxplot.png/pdf 各方法分组箱线图 免疫浸润合并结果表：tme_combine.txt每行一个样本，每列为不同免疫细胞类型的浸润分数。除免疫浸润不同免疫细胞评分外，还有基质评分信息。StromalScore_estimate为基质细胞总量，ImmuneScore_estimate为免疫细胞总量，ESTIMATEScore_estimate为非肿瘤成分即基质细胞与免疫细胞总量，这三列得分若为负数表示该类型成分几乎没有。TumorPurity_estimate列为肿瘤细胞占比，该值从0到1分布。 | SampleID | Macrophages_M2_CIBERSORT | CD8_T_Cells_EPIC | ... | | -------- | -------------------------- | ------------------- | --- | | Sample1 | 0.123 | 0.456 | ... | | Sample2 | 0.234 | 0.567 | ... | 免疫浸润热图：tme_heatmap.png/pdf 展示所有样本的免疫浸润分数热图，颜色表示分数高低。Group为--group_col设置的分组类型。如图为癌区与非癌区进行比较。Methods为本模块6种免疫浸润方法的结果。通过该图可看出哪些方法区分出了目标细胞或近似细胞类型，同时能看出癌区与正常组织整体是否有差异。 基质评分热图： StromaScore_heatmap.png/pdf展示样本的基质评分热图。基质评分用以量化肿瘤微环境（TME）中基质细胞、免疫细胞浸润程度及肿瘤纯度。 免疫浸润方法可视化图 (immune_plots目录) 积柱状图_stacked_bar.png/pdf ：各免疫细胞类型在不同样本/分组中的比例。 分组箱线图_grouped_boxplot.png/pdf：各免疫细胞类型在不同分组中的分布。 # © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/bulk_validate/02_geneset.html":{"url":"readme/04_manual/bulk_validate/02_geneset.html","title":"基因集评分模块","keywords":"","body":"基因集评分模块用途输入文件示例运行方式输入参数说明输出结果展示结果解读说明基因集评分模块 用途 本模块基于AUCell、GSVA、IOBR等R包，对自定义基因集在bulk RNA-Seq数据的表达矩阵中的活性进行多种方法打分，并可视化分组热图 支持的基因集评分算法 ssGSEA: 基于基因表达排序的累积分布计算富集分数，支持单样本分析 GSVA: 核密度估计基因表达分布，输出标准化富集分数 PCA: 基因表达标准化后主成分分析，取第一主成分得分 Z-score: 计算基因集内基因的Z-score均值 AUCell: 基于基因表达排名，计算基因集在前5%高表达基因的曲线下面积（AUC） 输入文件示例 expression表达矩阵文件：每行一个基因名，每列一个样本名，数值为对应的表达量，tab分割 GeneID Sample1 Sample2 Sample3 GENE1 1.234 2.345 3.456 GENE2 4.567 5.678 6.789 clinical临床信息文件：每行一个样本名，每列一个临床特征，tab分割 SampleID tissue_type.samples age gender Sample1 Tumor 45 Male Sample2 Normal 50 Female Sample3 Tumor 55 Male gene_set基因集合文件：表头为基因集合名称，每行一个基因名 test_genesetCD8ACD8BGZMAGZMB 运行方式 SDAS bulkValidate geneSetScore --expression fpkm.txt --gene_set geneset.txt --clinical clinical.txt --group_col tissue_type.samples --group_type discrete --output result_dir 输入参数说明 参数 是否必需 默认值 描述 --expression 是 表达矩阵文件路径。制表符分隔，行：基因ID，列：样本ID，值为FPKM/TPM等，不可为原始counts，不可log --clinical 是 临床信息文件路径。制表符分隔，行：样本ID，列：临床特征 --group_col 是 分组列名（需在临床信息文件中存在） --gene_set 是 自定义基因集文件路径。第一行为基因集名称（如test_geneset）后续每行一个基因名 --output 是 输出目录路径 --group_type 否 discrete 分组类型：discrete/continuous，默认discrete --group_type 分组类型说明 离散分组 (discrete)：直接使用临床信息中的分类变量进行分组，例如：Tumor vs Normal, Stage I vs Stage II vs Stage III 连续分组 (continuous)：将连续变量按分位数分为三组：Low, Medium, High 分位数：0%, 30%, 70%, 100% 输出结果展示 结果文件 描述 genescore_combine.txt 所有打分方法的合并结果 geneset_score_heatmap.png/pdf 不同打分方法分组热图 基因集评分结果表：genescore_combine.txt 每行一个样本，每列为不同打分方法的结果。 | SampleID | test_geneset_AUCell | test_geneset_GSVA | test_geneset_zscore | test_geneset_ssGSEA | test_geneset_PCA | | -------- | --------------------- | ------------------- | --------------------- | --------------------- | ------------------ | | Sample1 | 0.123 | 0.456 | 9.065 | 9.065 | 9.065 | | Sample2 | 0.234 | 0.567 | 0.0677 | 0.0677 | 0.0677 | 基因集打分热图：geneset_score_heatmap.png/pdf 展示所有样本指定基因集的表达分数。 结果解读说明 基因集评分结果表：genescore_combine.txt ​若使用TCGA bulk转录组​，优先选择GSVA或ssGSEA​进行解读，这两种方法结果稳健，可支持复杂通路 若​需保留基因相关性​，优先选择PCA​进行解读 若想​快速分析​，优先选择Z-score​进行解读 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/04_manual/bulk_validate/03_survival.html":{"url":"readme/04_manual/bulk_validate/03_survival.html","title":"生存分析模块","keywords":"","body":"生存分析模块用途输入文件示例运行方式输入参数说明输出结果展示生存分析模块 用途 本模块基于IOBR、survival、survminer等R包，对免疫浸润/基因集打分结果与生存信息进行单因素生存分析，并输出标准化的生存曲线图。 输入文件示例 input特征打分/免疫浸润结果文件：每行一个样本名，每列为各类免疫细胞/基因集打分等特征，tab分割 SampleID Macrophages_M2_CIBERSORT CD8_T_Cells_EPIC Sample1 0.123 0.456 Sample2 0.234 0.567 Sample3 0.345 0.678 clinical生存信息文件：每行一个样本名，每列为生存时间、生存状态等特征，tab分割 SampleID OS.time OS DFS.time DFS Sample1 1000 1 800 0 Sample2 800 0 600 0 Sample3 1200 1 1000 1 运行方式 SDAS bulkValidate survivalKM --input tme_combine.txt --clinical survival.txt --signature Macrophages_M2_CIBERSORT --project_name survival --time OS.time --status OS.status --time_type day --output survival_output 输入参数说明 参数 必需 默认值 描述 --input 是 免疫浸润/打分结果文件路径 --clinical 是 生存信息文件路径 --signature 是 用于生存分析的特征列名 --output 是 输出目录路径 --project_name 否 test 项目名称（用于输出文件命名等） --time 否 OS.time 生存时间列名 --status 否 OS.status 生存状态列名（0=生存/无复发，1=死亡/复发） --time_type 否 day 时间单位，默认day 输出结果展示 结果文件 描述 survival.png/pdf 生存曲线图 生存曲线图: survival.png/pdf展示指定特征分组下的生存分析曲线，显示高低组生存差异。 分组方法的区别： 最佳截断值（best cutoff）分组：通过统计方法寻找将两组生存差异最大化的截断值。通常能最显著地区分出高风险组和低风险组（如左图所示）。 平均数分组： 以所有样本得分的平均数作为分界点。这种方法在数据分布对称时效果较好，但在偏态分布时可能不够敏感（如中图所示）。 三等分组： 将样本按照得分分为三等分（低、中、高）。这种方法高低分组的差异可能不如前两种方法显著（如右图所示），但能避免极端值影响，并观察中间组的影响。 统计指标的含义： P值： 表示组间生存差异的显著性。P值越小，表明组间差异越不可能由随机因素导致。 Hazard Ratio（风险比，HR）： 表示高分组相对于低分组的死亡风险倍数。HR>1表示高风险 95% CI（置信区间）： 表示HR的95%置信区间，反映估计的精确度。区间不包含1（如左图1.41-2.64）表示HR显著不等于1。区间越窄，估计越精确。 Cutoff值：最佳截断值分组方法中使用的分界点。 生存曲线：展示了高分组（橙色）和低分组（蓝色）的生存概率随时间变化情况。曲线分离越明显，组间差异越大。 风险表（Number at risk）： 在时间点下方显示各组的风险人数（即到该时间点还未发生终点事件的人数），这有助于评估随着时间的推移各组的样本数量变化。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/05_pipline/":{"url":"readme/05_pipline/","title":"流程示例","keywords":"","body":"六、流程示例六、流程示例 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/05_pipline/02_qsub.html":{"url":"readme/05_pipline/02_qsub.html","title":"集群投递模式","keywords":"","body":"集群投递模式简介系统要求使用步骤1. 配置pipeline_input.conf文件2. 生成作业配置3. 预览作业（推荐）4. 提交作业auto_qsub_scheduler.py 作业调度系统配置测试数据和配置文件目录结构单片数据分析配置多片数据分析配置测试步骤集群投递模式 简介 SDAS Pipelines 自动化投递任务是一个智能的作业调度系统，用于自动管理和提交SDAS分析流程的作业到PBS/Torque集群。该系统能够： 自动解析依赖关系：根据作业间的依赖关系智能调度 并发控制：限制同时运行的作业数量，避免资源冲突 状态监控：实时监控作业执行状态 错误处理：自动重试失败的作业 详细报告：生成完整的执行报告和日志 系统要求 Python 3.6+ 作业调度系统（支持以下任一种）： PBS/Torque SGE (Sun Grid Engine) Slurm LSF (IBM Platform Load Sharing Facility) 适当的队列权限 SDAS软件已正确配置 使用步骤 1. 配置pipeline_input.conf文件 在运行SDAS Pipeline之前，需要先配置 pipeline_input.conf 文件。这个文件定义了： 输入数据：h5ad文件路径和分组信息 分析流程：选择要运行的SDAS模块 模块参数：每个模块的具体参数配置 依赖关系：模块间的输入输出关系 1.1 基本配置结构 # 1. 软件路径 SDAS_software = /path/to/SDAS # 2. 输入数据配置 # 单文件输入 h5ad_files = /path/to/data.h5ad # 多文件输入（带分组信息） h5ad_files = S1,group1,A.h5ad;S2,group1,B.h5ad;S3,group2,C.h5ad # 多文件输入（无分组信息） h5ad_files = S1,,A.h5ad;S2,,B.h5ad # 3. 分析流程选择 process = coexpress,spatialDomain,cellAnnotation,cellularNeighborhood,CCI,trajectory,DEG,geneSetEnrichment,TF,PPI,spatialRelate 1.2 模块参数配置示例 配置说明： 参数格式：参数名 = 参数值 空格表示：参数值为空，使用默认值 注释：以 # 开头，用于说明参数含义 路径参数：使用绝对路径，避免相对路径问题 空间基因共表达分析 (coexpress) # 基本参数 coexpress_input_process = basic coexpress_method = hotspot # 可选: hotspot, nest, hdwgcna coexpress_bin_size = 100 coexpress_selected_genes = top5000 # Hotspot参数 hotspot_fdr_cutoff = 0.05 hotspot_model = normal 细胞类型注释 (cellAnnotation) # 基本参数 cellAnnotation_input_process = basic cellAnnotation_method = rctd # 可选: cell2location, spotlight, rctd, tangram, scimilarity # RCTD参数 rctd_reference = /path/to/reference.h5ad rctd_label_key = annotation rctd_bin_size = 100 rctd_input_gene_symbol_key = real_gene_name rctd_ref_gene_symbol_key = _index rctd_filter_rare_cell = 100 rctd_n_cpus = 8 空间结构域识别 (spatialDomain) # 基本参数 spatialDomain_input_process = basic spatialDomain_method = graphst # GraphST参数 graphst_tool = mclust graphst_bin_size = 100 graphst_n_clusters = 10 graphst_n_hvg = 3000 graphst_gpu_id = -1 1.3 模块依赖关系配置 SDAS模块之间存在依赖关系，通过 *_input_process 参数指定： # 基础模块（无依赖） coexpress_input_process = basic spatialDomain_input_process = basic cellAnnotation_input_process = basic # 依赖其他模块 cellularNeighborhood_input_process = cellAnnotation CCI_input_process = cellularNeighborhood trajectory_input_process = cellAnnotation DEG_input_process = spatialDomain geneSetEnrichment_input_process = spatialDomain spatialRelate_input_process = cellAnnotation 2. 生成作业配置 配置完成后，运行SDAS Pipeline生成作业配置文件： python3 SDAS_pipeline.py -c pipeline_input.conf -o ./output 这将生成 all_shell.conf 文件，包含所有作业及其依赖关系。 3. 预览作业（推荐） 在实际提交前，建议先使用dry-run模式预览： python3 auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output --dry-run 这将显示： 所有作业的依赖关系 资源需求（CPU、内存） 将要生成的qsub脚本 4. 提交作业 确认无误后，提交作业到队列： python3 auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output auto_qsub_scheduler.py 作业调度系统配置 根据您的集群环境，需要修改 auto_qsub_scheduler.py 中的 create_qsub_script 方法来自定义作业提交脚本的格式。该方法位于文件的 QsubScheduler 类中： def create_qsub_script(self, shell_file: str, cpu: int, memory: int) -> str: \"\"\" 生成qsub作业提交脚本 参数: shell_file: 要执行的shell脚本路径 cpu: CPU核心数 memory: 内存需求(GB) 返回: 生成的qsub脚本内容 \"\"\" # 在这里根据您的作业调度系统修改脚本模板 script = f\"\"\"#!/bin/bash #PBS -q {self.queue} #PBS -N {os.path.basename(shell_file)} #PBS -o {shell_file}.log #PBS -j oe #PBS -l nodes=1:ppn={cpu} #PBS -l mem={memory}gb cd $PBS_O_WORKDIR bash {shell_file} \"\"\" return script 您需要： 根据您的作业调度系统（PBS/Torque、SGE、Slurm或LSF）修改脚本模板 确保包含必要的资源配置参数（CPU、内存等） 保留对以下变量的引用： self.queue: 队列名称 shell_file: 执行脚本路径 cpu: CPU核心数 memory: 内存需求 测试数据和配置文件 SDAS Pipelines提供了单片和多片测试数据及对应的配置文件，方便用户快速上手和测试系统。 目录结构 SDAS_download/ ├── Scripts/ │ └── pipeline_cluster/ │ ├── auto_qsub_scheduler.py # 自动化投递脚本 │ ├── SDAS_pipeline.py # Pipeline生成脚本 │ ├── pipeline_input.single_slice.conf # 单片数据配置示例 │ └── pipeline_input.multiple_slice.conf # 多片数据配置示例 └── Test_data/ ├── single_slice/ # 单片测试数据 │ └── sample.h5ad └── multiple_slices/ # 多片测试数据 ├── P19_NT_transition.h5ad ├── P19_T_transition.h5ad ├── P34_NT_transition.h5ad ├── P34_T_transition.h5ad ├── P33_T_transition.h5ad └── P36_T_transition.h5ad 单片数据分析配置 pipeline_input.single_slice.conf 针对单个空间转录组切片的分析流程： 输入数据：单个h5ad文件 分析模块：包含大多数SDAS分析模块 特点： 简单的数据输入配置 完整的模块参数示例 适合初次使用的用户 多片数据分析配置 pipeline_input.multiple_slice.conf 针对多个空间转录组切片的分析流程： 输入数据：多个h5ad文件，包含分组信息（如Normal/Tumor） 分析模块：根据实验设计选择合适的模块 特点： 展示了多样本输入格式 包含组间比较的参数设置 适合进行对照分析 测试步骤 1. 单片数据测试 步骤1：准备配置文件 # 1. 复制配置文件到工作目录 cp Scripts/pipeline_cluster/pipeline_input.single_slice.conf ./ # 2. 修改配置文件中的路径 # - SDAS_software路径 # - h5ad_files路径 # - 参考数据路径（如果需要） 步骤2：生成作业配置 # 运行Pipeline生成作业配置 python3 Scripts/pipeline_cluster/SDAS_pipeline.py -c pipeline_input.single_slice.conf -o ./output_single_slice 步骤3：预览作业（推荐） # 使用dry-run模式预览作业配置 python3 Scripts/pipeline_cluster/auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output_single_slice --dry-run 步骤4：提交作业 # 实际提交作业到队列 python3 Scripts/pipeline_cluster/auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output_single_slice 2. 多片数据测试 步骤1：准备配置文件 # 1. 复制配置文件到工作目录 cp Scripts/pipeline_cluster/pipeline_input.multiple_slice.conf ./ # 2. 修改配置文件中的路径 # - SDAS_software路径 # - h5ad_files路径（多个文件路径） # - 参考数据路径（如果需要） 步骤2：生成作业配置 # 运行Pipeline生成作业配置 python3 Scripts/pipeline_cluster/SDAS_pipeline.py -c pipeline_input.multiple_slice.conf -o ./output_multiple_slice 步骤3：预览作业（推荐） # 使用dry-run模式预览作业配置 python3 Scripts/pipeline_cluster/auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output_multiple_slice --dry-run 步骤4：提交作业 # 实际提交作业到队列 python3 Scripts/pipeline_cluster/auto_qsub_scheduler.py -c ./output/all_shell.conf -o ./output_multiple_slice © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/05_pipline/01_single.html":{"url":"readme/05_pipline/01_single.html","title":"单机服务器模式","keywords":"","body":"单机服务器模式简介系统要求使用步骤1. 配置pipeline_input.conf文件2.一键式运行单机服务器模式 简介 SDAS_pipeline_subprocess.py 提供了一个简单的方式，可以在单机服务器上一键式运行SDAS的大部分模块。 系统要求 Python 3.6+ SDAS软件已正确配置 服务器配置需达到SDAS系统配置要求 使用步骤 1. 配置pipeline_input.conf文件 参见集群投递模式配置 2.一键式运行 -c 指定配置文件，-o 指定输出文件夹： python SDAS_pipeline_subprocess.py -c pipeline_input.conf -o ./output 单片数据测试： python SDAS_pipeline_subprocess.py -c pipeline_input.single_slice.conf -o ./output_single 多片数据测试： python SDAS_pipeline_subprocess.py -c pipeline_input.multiple_slice.conf -o ./output_multi © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/06_version.html":{"url":"readme/06_version.html","title":"版本说明","keywords":"","body":"版本说明SDAS发版记录 历史版本 版本说明 SDAS发版记录 1.0.0（8月, 2025） 初次发版 包含14个功能模块，共31个算法/方法。具体有：数据处理，细胞类型注释，空间结构域识别，细胞邻域分析，CNV分析，空间基因共表达，差异基因识别，基因集富集分析，基因调控网络分析，细胞通讯分析，轨迹分析，转录因子分析，细胞空间距离分析，和公共数据库验证。 历史版本 历史版本信息可以从 GitHub 获取。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/07_support/":{"url":"readme/07_support/","title":"技术支持","keywords":"","body":"技术支持技术支持 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/07_support/faq.html":{"url":"readme/07_support/faq.html","title":"常见问题","keywords":"","body":"常见问题1. 输入文件的格式是什么样的？ 2. 细胞注释模块有5种算法，Spotlight\\cell2location\\RCTD\\Tangram均需要对应的scRNA-Seq数据，SDAS是否提供，如果不提供，用户应该如何准备？ 3. SDAS中的各模块支持scRNA-Seq数据分析吗，如果支持，用户应该如何准备单细胞数据？ 4. 基于SDAS各模块输出结果，进行可视化作图，是否有支持方案？ 常见问题 1. 输入文件的格式是什么样的？ 答：SDAS支持SAW count，SAW gef2h5ad，SAW aggr(alpha ver.)的输出文件；同时支持用户按照SDAS输入数据格式描述自行准备的文件。 2. 细胞注释模块有5种算法，Spotlight\\cell2location\\RCTD\\Tangram均需要对应的scRNA-Seq数据，SDAS是否提供，如果不提供，用户应该如何准备？ 答：SDAS软件暂时不提供细胞注释的单细胞数据，用户需要按照使用手册中的格式说明来准备h5ad文件。 3. SDAS中的各模块支持scRNA-Seq数据分析吗，如果支持，用户应该如何准备单细胞数据？ 答：SDAS中的dataProcess，DEG, geneSetEnrichment, inferCNV，CCI, trajectory，转录因子分析模块均支持scRNA-Seq数据分析，用户按照使用手册准备输入文件（h5ad或rds）即可。 4. 基于SDAS各模块输出结果，进行可视化作图，是否有支持方案？ 答：SDAS的每个模块具有独立的环境，且每个环境中安装有jupyter kernel（ipykernel/IRkernel），支持用户直接调用该环境使用Jupyter Notebook等交互式环境画图。 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/07_support/log.html":{"url":"readme/07_support/log.html","title":"SDAS日志和退出码规范","keywords":"","body":"SDAS日志和退出码规范日志退出码SDAS日志和退出码规范 日志 SDAS将标准输出（stdout）与错误信息（stderr）进行分离，方便用户快速定位问题 标准输出分类：打印正常结果，程序运行状态（如进度条，成功消息等） 错误信息分类：错误信息，警告信息，异常信息 运行示例：example_bash_script > stdout.log 2> stderr.log & stdout.log文件将包含正常输出 stderr.log文件将包含错误信息 退出码 退出码通常是由程序在运行结束时返回给操作系统的状态码，用于表示程序的运行结果是否成功。通常返回值 0 表示程序正常退出，非 0 表示程序因错误退出，方便后续在脚本中(如WDL、snakemake等)通过退出码来判断程序完成状态。 SDAS退出码定义如下： 正常退出：0 核心算法main function错误：1 命令行参数错误: 2 输入文件格式或者内容错误：3 输出文件错误：4 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/07_support/saw_aggr.html":{"url":"readme/07_support/saw_aggr.html","title":"SAW aggr(alpha ver.)流程介绍","keywords":"","body":"SAW aggr(alpha ver.)流程介绍1. SAW aggr是什么2. 如何与SDAS进行衔接3. 如何获取SAW aggr（alpha ver.）SAW aggr(alpha ver.)流程介绍 1. SAW aggr是什么 包含数据整合、去批次、聚类、差异基因的多片分析和可视化流程 2. 如何与SDAS进行衔接 SAW aggr生成的h5mu文件，通过SDAS dataProcess h5mu2h5ad即可转成SDAS的标准输入格式 3. 如何获取SAW aggr（alpha ver.） 包括软件和使用手册，测试数据和测试结果报告 华大网盘 https://bgipan.genomics.cn/#/link/vfaGuYJLpxgrpGzZ7fdn 提取密码：YUM0 © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"readme/07_support/reference.html":{"url":"readme/07_support/reference.html","title":"参考文献及Github","keywords":"","body":"参考文献及Github参考文献及Github 算法/方法参考文献链接github链接SpotlightSPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomeshttps://github.com/MarcElosua/SPOTlightcell2locationCell2location maps fine-grained cell types in spatial transcriptomicshttps://github.com/BayraktarLab/cell2location/RCTDRobust decomposition of cell type mixtures in spatial transcriptomicshttps://github.com/dmcable/spacexrTangramDeep learning and alignment of spatially resolved single-cell transcriptomes with Tangramhttps://github.com/broadinstitute/TangramSCimilarityA cell atlas foundation model for scalable search of similar human cellshttps://github.com/Genentech/scimilarityGraphSTSpatially informed clustering, integration, and deconvolution of spatial transcriptomics with GraphSThttps://github.com/JinmiaoChenLab/GraphSTinferCNVSingle-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastomahttps://github.com/broadinstitute/infercnvHotspotHotspot identifies informative gene modules across modalities of single-cell genomicshttps://github.com/YosefLab/HotspotNeSTNeST: nested hierarchical structure identification in spatial transcriptomic datahttps://github.com/bwalker1/NeSThdWGCNAhdWGCNA identifies co-expression networks in high-dimensional transcriptomics datahttps://github.com/smorabit/hdWGCNAscanpy（t-test、Wilcoxon）SCANPY: large-scale single-cell gene expression data analysishttps://github.com/scverse/scanpyDESeq2Dictionary learning for integrative, multimodal and scalable single-cell analysishttps://github.com/satijalab/seuratedgeRedgeR: a Bioconductor package for differential expression analysis of digital gene expression datahttps://bioconductor.org/packages/devel/bioc/html/edgeR.htmlMASTMAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing datahttps://github.com/RGLab/MASTgsea/enrichr/prerank/gsvaGSEApy: a comprehensive package for performing gene set enrichment analysis in Pythonhttps://github.com/zqfang/GSEApycellchat v2CellChat for systematic analysis of cell–cell communication from single-cell transcriptomicshttps://github.com/jinworks/CellChatcellphoneDBCellPhoneDB v5: inferring cell–cell communication from single-cell multiomics datahttps://github.com/ventolab/CellphoneDBmonocle3The single-cell transcriptional landscape of mammalian organogenesishttps://github.com/cole-trapnell-lab/monocle3pySCENICA scalable SCENIC workflow for single-cell gene regulatory network analysishttps://github.com/aertslab/pySCENICSTRINGdbThe STRING database in 2023: protein–protein association networks and functional enrichment analyses for any sequenced genome of interest-SquidpySquidpy: a scalable framework for spatial omics analysishttps://github.com/scverse/squidpyCRAWDADCharacterizing cell-type spatial relationships across length scales in spatially resolved omics datahttps://github.com/JEFworks-Lab/CRAWDADCellular Neighborhood Analysis: Single Cell Type ModeCoordinated Cellular Neighborhoods Orchestrate Antitumoral Immunity at the Colorectal Cancer Invasive FrontConserved spatial subtypes and cellular neighborhoods of cancer-associated fibroblasts revealed by single-cell spatial multi-omics-Cellular Neighborhood Analysis: Cell Type Score ModeSpatial multi-omic map of human myocardial infarction-​immuneScore​/geneSetScore/survivalKMFrontiers | IOBR: Multi-Omics Immuno-Oncology Biological Research to Decode Tumor Microenvironment and Signatureshttps://github.com/IOBR/IOBR © 2025 STOmics Tech. All rights reserved.Modified: 2025-07-31 19:28:56 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"}}